function AuthMinderPlugin(){}AuthMinderPlugin.plugin=null;AuthMinderPlugin.pluginMissing=false;AuthMinderPlugin.E_SUCCESS=1000;AuthMinderPlugin.prototype.getPlugin=function(){if(AuthMinderPlugin.pluginMissing){return null}if(AuthMinderPlugin.plugin==null){this.loadPlugin()}if(AuthMinderPlugin.plugin!=null){if(!("GetDeviceDNA" in AuthMinderPlugin.plugin)){aotpLog("Reloading the plugin");this.removePlugin();this.loadPlugin()}}return AuthMinderPlugin.plugin};AuthMinderPlugin.prototype.isPluginInstalled=function(){try{if(this.is64BitBrowser()){return window.ActiveXObject?(new ActiveXObject("CA.AuthMinder64")!=null):(typeof(navigator.plugins["CA Technologies AuthMinder64"])!="undefined")}return window.ActiveXObject?(new ActiveXObject("CA.AuthMinder")!=null):(typeof(navigator.plugins["CA Technologies AuthMinder"])!="undefined")}catch(a){}return false};AuthMinderPlugin.prototype.loadPlugin=function(){aotpLog("Attempting to load the plugin");if(this.isPluginInstalled()){try{if(document.getElementById("arcotjsapiPlugin")==null){var g=document.createElement("div");g.setAttribute("id","arcotjsapiPluginDiv");g.setAttribute("display","none");if(this.is64BitBrowser()){g.innerHTML='<object id="arcotjsapiPlugin" type="application/x-caauthminder-x64" width="0" height="0"></object>'}else{g.innerHTML='<object id="arcotjsapiPlugin" type="application/x-caauthminder" width="0" height="0"></object>'}document.body.appendChild(g)}var d=document.getElementById("arcotjsapiPlugin");if(d&&"GetVersion" in d){var b=d.GetVersion();aotpLog("Plugin found, version is: "+b);var c={version:"1",DNA:null};var a=d.GetDeviceDNA(c);if(a==AuthMinderPlugin.E_SUCCESS){aotpLog("Plugin loaded and is working. Version: "+d.GetVersion());aotpLog("DeviceID is: "+c.DNA);AuthMinderPlugin.plugin=d;return}else{aotpLog("Plugin returned: "+a)}}else{aotpLog("Plugin did not load")}}catch(f){aotpLog("Exception while loading plugin: "+f)}}else{aotpLog("Plugin is not present")}aotpLog("Plugin not available");AuthMinderPlugin.plugin=null;AuthMinderPlugin.pluginMissing=true};AuthMinderPlugin.prototype.removePlugin=function(){var a=document.getElementById("arcotjsapiPluginDiv");if(a!=null){document.body.removeChild(a)}AuthMinderPlugin.plugin=null};AuthMinderPlugin.prototype.is64BitBrowser=function(){var a=false;if((window.navigator.cpuClass!=null&&window.navigator.cpuClass.toLowerCase()=="x64")||window.navigator.platform.toLowerCase()=="win64"){a=true}return a};function StoreBase(d){if(d&&"inheriting" in d&&d.inheriting){return}this.availableImpls=[];var b=[];if(d&&"storageType" in d&&d.storageType){b.push(new d.storageType)}else{b.push(new StoreImplPlugin());b.push(new StoreImplLocalStorage());b.push(new StoreImplUserData());b.push(new StoreImplCookies())}for(var c=0;c<b.length;c++){var a=b[c];if(typeof a.getType=="function"&&typeof a.loadAll=="function"&&typeof a.load=="function"&&typeof a.remove=="function"&&typeof a.save=="function"&&this.isAvailable(a)){this.availableImpls.push(a)}}var g=this.availableImpls.length;if(g==0){throw"No store available"}this.impl=this.availableImpls[0];var f=d&&"autoMigrate" in d?d.autoMigrate:true;if(f){this.migrate()}}StoreBase.prototype.getType=function(){return this.impl?this.impl.getType():null};StoreBase.prototype.loadAll=function(h){var a=[];var k=[];var j={};var b;try{b=this.impl.loadAll(j);if(j.dltus!=undefined&&j.dltus!=null){for(var d=0;d<b;d++){var g=j.values[d];var m=j.dltus[d];if(g!=null){var l=j.keys[d];if(this.isValidEntry(l,g)){a.push(l);var c=this.deserialize(g);c.dltu=m;k.push(c)}}}}else{for(var d=0;d<b;d++){var g=j.values[d];if(g!=null){var l=j.keys[d];if(this.isValidEntry(l,g)){a.push(l);k.push(this.deserialize(g))}}}}}catch(f){}h.keys=a;h.values=k;return a.length};StoreBase.prototype.load=function(a){try{var c=this.impl.load(a);if(c==null){return null}if(c&&this.isValidEntry(a,c)){return this.deserialize(c)}}catch(b){}return null};StoreBase.prototype.remove=function(a){try{return this.impl.remove(a)}catch(b){}return false};StoreBase.prototype.save=function(a,c,b){try{return this.impl.save(a,this.serialize(c),b)}catch(d){}return false};StoreBase.prototype.serialize=function(a){throw"serialize not overridden"};StoreBase.prototype.deserialize=function(a){throw"deserialize not overridden"};StoreBase.prototype.isValidEntry=function(a,b){throw"isValidEntry not overridden"};StoreBase.prototype.isAvailable=function(b){var a=false;var f="arcottest_"+b.getType();var c=new Date().getTime().toString();try{b.save(f,c);a=b.load(f)==c;b.remove(f)}catch(d){}return a};StoreBase.prototype.sbDeviceLock=function(){if(typeof this.deviceLock=="function"){this.deviceLock.apply(this,arguments)}};StoreBase.prototype.sbDeviceUnlock=function(){if(typeof this.deviceUnlock=="function"){this.deviceUnlock.apply(this,arguments)}};StoreBase.prototype.migrate=function(){var l=this.availableImpls.length;aotpLog("migrateKeys: number of stores: "+l);if(l<2){return}var h=this.availableImpls[0];var f={};h.loadAll(f);var g={};var n=f.keys;for(var d=0;d<n.length;d++){g[n[d]]=1}for(var r=1;r<this.availableImpls.length;r++){var a=this.availableImpls[r];var k={};var m=a.loadAll(k);var q=k.keys;var p=k.values;for(var d=0;d<m;d++){var o=q[d];if(o=="arcot.wallet.memory"){continue}var j=p[d];if(j&&this.isValidEntry(o,j)){aotpLog("migrateKeys:  key: "+o);if(!(o in g)){var b={};var c=this.deserialize(j);this.sbDeviceUnlock(c,a.getType());this.sbDeviceLock(c,h.getType());j=this.serialize(c);if(h.getType()=="plugin"&&c.dltu){b.inputAttributes=c.dltu}aotpLog("migrateKeys: adding enter to master store: "+o);h.save(o,j,b);g[o]=1}aotpLog("migrateKeys: removing entry from lesser store: "+o);a.remove(o)}}}};function StoreString(a){StoreBase.call(this,a);return}StoreString.prototype=new StoreBase({inheriting:true});StoreString.prototype.serialize=function(a){return a};StoreString.prototype.deserialize=function(a){return a};StoreString.prototype.isValidEntry=function(a,b){return true};var ArcotCookieUtils={loadAll:function(f){var h=[];var g=[];var a=document.cookie.split(";");for(var b=0;b<a.length;b++){var j=a[b];while(j.charAt(0)==" "){j=j.substring(1,j.length)}var d=j.split("=");if(d!=null&&d[1]!=null){h.push(d[0]);g.push(unescape(d[1]))}}f.keys=h;f.values=g;return h.length},load:function(d){var a=document.cookie.split(";");for(var b=0;b<a.length;b++){var f=a[b];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(d+"=")==0){return unescape(f.substring(d.length+1,f.length))}}return null},remove:function(a){var b=new Date(0);document.cookie=a+"=;expires="+b.toGMTString();document.cookie=a+"=;expires="+b.toGMTString()+"; path=/";return true},save:function(c,d,a){var b=d?escape(d):"";if(a){var f=new Date();f.setDate(f.getDate()+1825);ArcotCookieUtils.remove(c);document.cookie=c+"="+b+";expires="+f.toGMTString()+"; path=/"}else{document.cookie=c+"="+b+"; path=/"}return true}};function StoreImplMemory(){}StoreImplMemory.prototype.getType=function(){return"memory"};StoreImplMemory.prototype.loadAll=function(a){return ArcotCookieUtils.loadAll(a)};StoreImplMemory.prototype.load=function(a){return ArcotCookieUtils.load(a)};StoreImplMemory.prototype.remove=function(a){return ArcotCookieUtils.remove(a)};StoreImplMemory.prototype.save=function(a,c,b){return ArcotCookieUtils.save(a,c,false)};function StoreImplCookies(){}StoreImplCookies.prototype.getType=function(){return"cookie"};StoreImplCookies.prototype.loadAll=function(a){return ArcotCookieUtils.loadAll(a)};StoreImplCookies.prototype.load=function(a){return ArcotCookieUtils.load(a)};StoreImplCookies.prototype.remove=function(a){return ArcotCookieUtils.remove(a)};StoreImplCookies.prototype.save=function(a,c,b){return ArcotCookieUtils.save(a,c,true)};function StoreImplLocalStorage(){try{var b=localStorage.length}catch(a){aotpLog("StoreLocalImpl: localStorage: "+a)}}StoreImplLocalStorage.prototype.getType=function(){return"LocalStorage"};StoreImplLocalStorage.prototype.loadAll=function(d){if(!this.available()){return null}var c=0;var f=[];var a=[];var b,g;while(c<999999){try{b=localStorage.key(c++)}catch(h){break}if(b==null){break}g=localStorage.getItem(b);f.push(b);a.push(g)}d.keys=f;d.values=a;return f.length};StoreImplLocalStorage.prototype.load=function(a){if(!this.available()){return null}return localStorage.getItem(a)};StoreImplLocalStorage.prototype.remove=function(a){if(!this.available()){return null}try{localStorage.removeItem(a)}catch(b){return false}return true};StoreImplLocalStorage.prototype.save=function(a,c,b){if(!this.available()){return null}try{localStorage.setItem(a,c)}catch(d){return false}return true};StoreImplLocalStorage.prototype.available=function(){try{if(typeof(localStorage)=="undefined"){return false}}catch(a){return false}return true};function StoreImplPlugin(){this.AMP=null}StoreImplPlugin.DLR="devlock_required";StoreImplPlugin.DLT="devlock_type";StoreImplPlugin.DEFAULT_DLTVALUE="vol_mac_moth_proc_encl";StoreImplPlugin.DLTU="devlock_typeused";StoreImplPlugin.DLTU_NONE="none";StoreImplPlugin.PLUGIN_DLT="inputAttributes";StoreImplPlugin.PLUGIN_DLTU="outputAttributes";StoreImplPlugin.prototype.getType=function(){return"plugin"};StoreImplPlugin.prototype.loadAll=function(h){var d=this.getPlugin();if(d==null){return null}var k=d.GetKeys();var j=[];var g=[];if(k!=null){for(var c=0;c<k.length;c++){try{var a={key:k[c],value:null};var b=d.Get(a);if(b==AuthMinderPlugin.E_SUCCESS){j.push(a.value);g.push(a.outputAttributes)}else{j.push(null);g.push(null)}}catch(f){j.push(null);g.push(null)}}}h.keys=k;h.values=j;h.dltus=g;return k.length};StoreImplPlugin.prototype.load=function(b){var c=this.getPlugin();if(c==null){return null}var d={key:b,value:null};var a=c.Get(d);if(a!=AuthMinderPlugin.E_SUCCESS){return null}return d.value};StoreImplPlugin.prototype.remove=function(b){var c=this.getPlugin();if(c==null){return false}var a=c.Delete(b);return(a==AuthMinderPlugin.E_SUCCESS)};StoreImplPlugin.prototype.save=function(b,f,c){var d=this.getPlugin();if(d==null){return false}var a;if(c!=undefined&&c!=null){c.key=b;c.value=f;a=d.Store(c)}else{a=d.Store({key:b,value:f})}return(a==AuthMinderPlugin.E_SUCCESS)};StoreImplPlugin.prototype.getPlugin=function getPlugin(){if(this.AMP==null){this.AMP=new AuthMinderPlugin()}return this.AMP?this.AMP.getPlugin():null};function DeviceLock(a){this.obj=a;this.dlversion="1"}DeviceLock.prototype.GetVersion=function(){return this.dlversion};DeviceLock.prototype.isValid=function(){try{var d=new AuthMinderPlugin().getPlugin();if(d){var c={};var a=d.GetDeviceDNA(c);if(a==AuthMinderPlugin.E_SUCCESS){var b=c.version;if(b==this.dlversion){return true}}}}catch(f){aotpLog("Exception while getting Plugin Device Lock version: "+f);return false}return false};DeviceLock.prototype.doDevLockMigration=function(a){return};DeviceLock.prototype.getKey=function getKey(a,h,b,d){try{var f=new AuthMinderPlugin().getPlugin();if(f){var i={version:"1",DNA:null};var c=f.GetDeviceDNA(i);if(c==AuthMinderPlugin.E_SUCCESS){var j=i.DNA;return j}}}catch(g){}return null};function DeviceLockV2(a){this.obj=a;this.dlversion="2"}DeviceLockV2.prototype.GetVersion=function(){return this.dlversion};DeviceLockV2.prototype.isValid=function isValid(){try{var d=new AuthMinderPlugin().getPlugin();if(d){var c={};var a=d.GetDeviceDNA(c);if(a==AuthMinderPlugin.E_SUCCESS){var b=c.version;if(b==this.dlversion){return true}}}}catch(f){aotpLog("Exception while getting Plugin Device Lock version: "+f);return false}return false};DeviceLockV2.prototype.doDevLockMigration=function(a){a.doDevLockMigrationV2()};DeviceLockV2.prototype.getKey=function getKey(a,h,b,d){try{var f=new AuthMinderPlugin().getPlugin();if(!f){return null}if(a&&(a.toUpperCase()=="FALSE"||a.toUpperCase()=="NO")){d.dltu=StoreImplPlugin.DLTU_NONE;return null}var i={version:"2",DNA:null};if(b){if((h!=undefined)&&h!=null){i.inputAttributes=h}else{i.inputAttributes=""}}else{if((h==undefined)||h==null){return null}i.inputAttributes=h}var c=f.GetDeviceDNA(i);if(c==AuthMinderPlugin.E_SUCCESS){var j=i.DNA;d.dltu=i.outputAttributes;return j}}catch(g){}return null};function StoreImplUserData(){this.maxage=0;this.userdata=null}StoreImplUserData.prototype.getType=function(){return"userData"};StoreImplUserData.prototype.loadAll=function(f){if(!this.checkUserDataLoaded()){return 0}var h=[];var c=[];try{var b=this.userdata.xmlDocument.firstChild.attributes;var a=b.length;for(var d=0;d<a;d++){var g=b[d];h.push(g.nodeName);c.push(g.nodeValue)}}catch(j){aotpLog("Exception in userData loadall: "+j)}f.keys=h;f.values=c;return h.length};StoreImplUserData.prototype.load=function(a){if(!this.checkUserDataLoaded()){return null}return this.userdata.getAttribute(a)};StoreImplUserData.prototype.remove=function(a){if(!this.checkUserDataLoaded()){return false}this.userdata.removeAttribute(a);this.userdata.save("ArcotUserDataStorage");return true};StoreImplUserData.prototype.save=function(a,c,b){if(!this.checkUserDataLoaded()){return false}this.userdata.setAttribute(a,c);this.userdata.save("ArcotUserDataStorage");return true};StoreImplUserData.prototype.checkUserDataLoaded=function(){if(this.userdata==null){this.loadUserData()}return this.userdata?true:false};StoreImplUserData.prototype.loadUserData=function(){aotpLog("Attempting to load the UserData");try{this.userdata=document.createElement("div");this.userdata.setAttribute("id","arcotuserdataDiv");this.userdata.setAttribute("display","none");this.userdata.style.display="none";this.userdata.style.behavior="url('#default#userData')";document.body.appendChild(this.userdata);if(this.maxage){var b=new Date().getTime();var a=b+this.maxage*1000;this.userdata.expires=new Date(a).toUTCString()}if(this.userdata.addBehavior){this.userdata.setAttribute("id","");if(this.userdata.XMLDocument.xml.indexOf("id")!==-1){this.userdata.load("ArcotUserDataStorage")}else{this.userdata=null}}}catch(c){aotpLog("Exception while loading userData: "+c);this.userdata=null}};StoreImplUserData.prototype.removeUserData=function(){if(this.userdata!=null){document.body.removeChild(this.userdata)}this.userdata=null};var ArcotErrorCodes={ERR_NONE:0,ERR_BAD_PIN:1,ERR_MISSING_WALLET:3,ERR_BAD_WALLET:6,ERR_ILLEGAL_CHALLENGE:17,ERR_UNKNOWN:18,ERR_ILLEGAL_DOMAIN_ACCESS:20};function ArcotJSClient(a,c){this.lastErrCode=0;this.lookupMode=0;try{if(!c){c=new DeviceLock(this);if(c.isValid()){ArcotLogger.log("V1 devicelocker")}else{c=new DeviceLockV2(this);if(c.isValid()){ArcotLogger.log("V2 devicelocker")}else{c=new DevLockerCurrent(this);if(c.isValid()){ArcotLogger.log("Current devicelocker, DL v3 or above")}else{c=null}}}}var b={autoMigrate:false,devicelocker:c};this.hdStore=a?new a(b):new StoreAID(b)}catch(d){ArcotLogger.log(d)}this.memoryStore=new StoreAIDMemoryStorage();this.aidStore=this.hdStore;this.aidStore.migrate();this.aidStore.doDevLockMigration();ArcotLogger.log("Using "+this.aidStore.getType()+" storage")}ArcotJSClient.prototype.GetVersion=function(){return"6.0.5.0"};ArcotJSClient.prototype.GetVersionEx=function(){return"CA Auth ID Javascript Client "+this.GetVersion()};ArcotJSClient.prototype.GetErrorCode=function(){return this.lastErrCode};ArcotJSClient.prototype.GetErrorMessage=function(){switch(this.lastErrCode){case ArcotErrorCodes.ERR_NONE:return"No error";case ArcotErrorCodes.ERR_BAD_PIN:return"Entered PIN was invalid";case ArcotErrorCodes.ERR_MISSING_WALLET:return"The user does not have an CA Auth ID wallet";case ArcotErrorCodes.ERR_BAD_WALLET:return"Invalid wallet";case ArcotErrorCodes.ERR_ILLEGAL_CHALLENGE:return"Missing or illegal authentication challenge";case ArcotErrorCodes.ERR_UNKNOWN:return"Unknown error";case ArcotErrorCodes.ERR_ILLEGAL_DOMAIN_ACCESS:return"CA Auth ID accessed from an unauthorized domain";default:return"Uncatalogued error"}};ArcotJSClient.prototype.SetAttribute=function(b,c){var a=false;if(b!=null){b=b.toLowerCase();if(b=="aid_lookup_mode"){if(c!=null){c=c.toLowerCase();if(c=="alias_and_username"){this.lookupMode=0;a=true}if(c=="username_only"){this.lookupMode=1;a=true}if(c=="alias_only"){this.lookupMode=2;a=true}}}if(b=="storagetype"){this.UpdateStore(c)}}return a};ArcotJSClient.prototype.GetGlobalAttribute=function(d){this.lastErrCode=ArcotErrorCodes.ERR_NONE;ArcotGlobalAttrib.parse(d);var c=null;switch(ArcotGlobalAttrib.type){case ArcotGlobalAttrib.NONE:if(d==""){c=""}break;case ArcotGlobalAttrib.WLT_CNT:c=""+this.aidStore.GetWalletCount();break;case ArcotGlobalAttrib.WLT_AID:c=null;break;case ArcotGlobalAttrib.WLT_NAM:var a=this.aidStore.GetWalletAt(ArcotGlobalAttrib.walletPos);c=""+a.walletname;break;case ArcotGlobalAttrib.WLT_ORG:var a=this.aidStore.GetWalletAt(ArcotGlobalAttrib.walletPos);c=""+a.arcotcards[0].orgname;break;case ArcotGlobalAttrib.CRD_CNT:c=null;break;case ArcotGlobalAttrib.CRD_NAM:c=null;break;case ArcotGlobalAttrib.CRD_SNO:c=null;break;case ArcotGlobalAttrib.CRD_DER:c=null;break;case ArcotGlobalAttrib.ALIAS_CNT:var h=ArcotGlobalAttrib.userNameOrAlias;var g=ArcotGlobalAttrib.appctxt;var f=ArcotGlobalAttrib.org;var b=this.GetWallet(h,f,g);c=(b==null?0:1);break;default:c=null;break}return c};ArcotJSClient.prototype.ImportArcotID=function(a,f,d){this.lastErrCode=ArcotErrorCodes.ERR_NONE;if(a==null||a.length==0){this.lastErrCode=ArcotErrorCodes.ERR_BAD_WALLET;return false}this.UpdateStore(f);var b=this.aidStore.deserialize(a);this.aidStore.deviceLock(b,this.aidStore.getType());var c=this.aidStore.Save(b,d);if(c!=ArcotErrorCodes.ERR_NONE){ArcotLogger.log("Error code is:"+c);this.lastErrCode=c;return false}return true};ArcotJSClient.prototype.RemoveArcotID=function(b,d,c){this.lastErrCode=ArcotErrorCodes.ERR_NONE;this.UpdateStore(c);var a=this.aidStore.Delete(b,d);if(!a){this.lastErrCode=ArcotErrorCodes.ERR_MISSING_WALLET}return a};ArcotJSClient.prototype.RemoveArcotIDEx=function(a,f,d,c){this.lastErrCode=ArcotErrorCodes.ERR_NONE;this.UpdateStore(c);var b=false;switch(this.lookupMode){case 0:b=this.aidStore.Delete(a,d);if(b){break}b=this.aidStore.DeleteByAlias(a,d,f);break;case 1:b=this.aidStore.Delete(a,d);break;case 2:b=this.aidStore.DeleteByAlias(a,d,f);break}if(!b){this.lastErrCode=ArcotErrorCodes.ERR_MISSING_WALLET}return b};ArcotJSClient.prototype.SignChallengeEx=function(d,a,g,f,c){this.lastErrCode=ArcotErrorCodes.ERR_NONE;var b=this.aidStore.Get(a,f);if(b==null){this.lastErrCode=ArcotErrorCodes.ERR_MISSING_WALLET;return null}return this.SignChallengeWithWallet(d,b,c)};ArcotJSClient.prototype.SignChallengeEx2=function(c,b,g,f,d){this.lastErrCode=ArcotErrorCodes.ERR_NONE;var a=this.GetWallet(g,d,f);if(a==null){this.lastErrCode=ArcotErrorCodes.ERR_MISSING_WALLET;return null}return this.SignChallengeWithWallet(c,a,b)};ArcotJSClient.prototype.SignChallengeWithWallet=function(H,z,f){if(H==null||H.length==0){this.lastErrCode=ArcotErrorCodes.ERR_ILLEGAL_CHALLENGE;return null}var o=new Date();var j=new ArcotAIDMobile.ArcotDigestRep(z.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageType,z.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.salt,z.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.iterationCount,z.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.checksum,z.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.start,z.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.span);if(!this.aidStore.deviceUnlock(this,this.aidStore.getType(),f,z)){this.decamkey=j.decrypt(f,ArcotAIDMobile.hexstr2bytes(z.arcotcards[0].arcotPrivateKey.camouflagedKey))}H=H.replace(/_/g,"+");var B=ArcotBase64.b64toBA(H);var m=new Array();m[0]=4;m[1]=B.length;for(var x=0;x<B.length;x++){m[x+2]=B[x]}var F=ArcotAIDMobile.getBytesToSign(m);var s=new ArcotJSBN.BigInteger(this.decamkey.rsakey.modulus,16);var D=new ArcotJSBN.BigInteger(this.decamkey.rsakey.exponent,16);var G=ArcotAIDMobile.arcotsign(s,D,F);if((G.length%2)!=0){G="0"+G}G="00"+G;var q=ArcotAIDMobile.hexstr2bytes(G);var r=new Array();r[0]=3;var k=ArcotAIDMobile.getLengthBytes(q.length);for(var x=0;x<k.length;x++){r[r.length]=k[x]}for(var x=0;x<q.length;x++){r[r.length]=q[x]}var A=new Array(48,14,6,10,96,134,72,1,134,249,70,9,2,0,5,0);var y=m.length+A.length+r.length;var C=new Array();C[0]=48;var a=ArcotAIDMobile.getLengthBytes(y);for(var x=0;x<a.length;x++){C[C.length]=a[x]}for(var x=0;x<m.length;x++){C[C.length]=m[x]}for(var x=0;x<A.length;x++){C[C.length]=A[x]}for(var x=0;x<r.length;x++){C[C.length]=r[x]}var l=ArcotAIDMobile.hexstr2bytes(z.arcotcards[0].certificate.rawdata);var p=new Array();p[0]=48;var w=ArcotAIDMobile.getLengthBytes(l.length);for(var x=0;x<w.length;x++){p[p.length]=w[x]}for(var x=0;x<l.length;x++){p[p.length]=l[x]}var u=new Array();u[0]=48;var g=3+p.length+C.length;var E=ArcotAIDMobile.getLengthBytes(g);for(var x=0;x<E.length;x++){u[u.length]=E[x]}u[u.length]=2;u[u.length]=1;u[u.length]=0;for(var x=0;x<p.length;x++){u[u.length]=p[x]}for(var x=0;x<C.length;x++){u[u.length]=C[x]}var c=ArcotAIDMobile.bytear2hexstr(u);var b=ArcotBase64.hex2b64(c);b=b.replace(/\+/g,"_");var h=new Date();ArcotLogger.log("time to sign: "+(h.getTime()-o.getTime()));return b};ArcotJSClient.prototype.GetWallet=function(a,c,d){var b=null;switch(this.lookupMode){case 0:b=this.aidStore.Get(a,c);if(b!=null){break}b=this.GetWalletByAlias(a,c,d);break;case 1:b=this.aidStore.Get(a,c);break;case 2:b=this.GetWalletByAlias(a,c,d);break}return b};ArcotJSClient.prototype.GetWalletByAlias=function(f,j,a){var l=null;var k=this.aidStore.GetAll();for(var c=0;c<k.length;c++){var b=k[c].b64EncodedArcotID;var g=WalletUtil.parse(b);g.dltu=k[c].dltu;var h="Alias."+a;var d=g.arcotcards[0].namedAttributes[h];if(d!=null){d=ArcotUtil.util_hex2str(d)}if(d!=null&&d.toUpperCase()==f.toUpperCase()){if(j==null||j.length==0){l=g;break}if(j.toUpperCase()==g.arcotcards[0].orgname.toUpperCase()){l=g}}}return l};ArcotJSClient.prototype.GetWalletIndexByAlias=function(g,k,a){var f=-1;var l=this.aidStore.GetAll();for(var c=0;c<l.length;c++){var b=l[c].b64EncodedArcotID;var h=WalletUtil.parse(b);var j="Alias."+a;var d=h.arcotcards[0].namedAttributes[j];if(d!=null){d=ArcotUtil.util_hex2str(d)}if(d!=null&&d.toUpperCase()==g.toUpperCase()){if(k==null||k.length==0){f=c;break}if(k.toUpperCase()==h.arcotcards[0].orgname.toUpperCase()){f=c}}}return f};ArcotJSClient.prototype.UpdateStore=function(a){if(a!=null){a=a.toLowerCase();if(a=="hd"){this.aidStore=this.hdStore}if(a=="memory"){this.aidStore=this.memoryStore}}};function aotpLog(){if(arguments.length<=1){ArcotLogger.log(arguments[0])}else{ArcotLogger.log(arguments[1])}}var ArcotGlobalAttrib=new function(){this.NONE=0;this.WLT_CNT=1;this.WLT_AID=2;this.WLT_NAM=3;this.WLT_ORG=4;this.CRD_CNT=5;this.CRD_NAM=6;this.CRD_SNO=7;this.CRD_DER=8;this.ALIAS_CNT=9;this.type=this.NONE;this.walletPos=0;this.cardPos=0;this.userNameOrAlias=null;this.appctxt=null;this.org=null;var a=/^\d+$/;this.parse=function(l){this.type=this.NONE;this.walletPos=0;this.cardPos=0;this.userNameOrAlias=null;this.appctxt=null;this.org=null;var o=".";if(l.length>7&&l.substr(0,7).toLowerCase()=="walletn"){o=l.charAt(7)}else{if(l.length>6&&l.substr(0,6).toLowerCase()=="wallet"){o=l.charAt(6)}else{if(l.length>5&&l.substr(0,5).toLowerCase()=="alias"){o=l.charAt(5)}}}var g=l.split(o);if(g.length==0){return}var f=0;var n=g[f];n=n.toLowerCase();if(n=="walletn"){var m=g[++f];if(m!=null){m=m.toLowerCase()}if(m==null){}else{if(m=="count"){this.type=this.WLT_CNT}else{if(a.test(m)){this.walletPos=parseInt(m);var k=g[++f];if(k!=null){k=k.toLowerCase()}if(k==null){this.type=this.WLT_AID}else{if(k=="name"){this.type=this.WLT_NAM}else{if(k=="org"){this.type=this.WLT_ORG}else{if(k=="cardn"){var j=g[++f];if(j!=null){j=j.toLowerCase()}if(j==null){}else{if(j=="count"){this.type=this.CRD_CNT}else{if(a.test(j)){this.cardPos=parseInt(j);var h=g[++f];if(h!=null){h=h.toLowerCase()}if(h==null){}else{if(h=="name"){this.type=this.CRD_NAM}else{if(h=="serialnumber"){this.type=this.CRD_SNO}}}}else{}}}}else{}}}}}else{}}}}if(n=="alias"){this.type=this.ALIAS_CNT;if(g.length==5||g.length==7){this.userNameOrAlias=g[1];this.appctxt=g[3];if(g.length==7){this.org=g[5]}}else{}}}};var ArcotAIDMobile={debug:false,randindex:0,fixedRandom:function(b,a){var c;for(c=0;c<a;c++){b[c]=ArcotAIDMobile.randindex++&255}return b},str2bytes:function(f){var b=new Array();var a=255;for(var d=0;d<f.length;d++){var g=(f.charCodeAt(d)&a);b[d]=g}return b},hexstr2bytes:function(g){var b=new Array();if((g.length%2)!=0){g="0"+g}var a=(g.length/2)&4294967295;var f=0;for(var d=0;d<a;d++){var h=parseInt(g.substring(f,f+2),16);b[d]=h;f+=2}return b},arraycopy:function(g,d,b,a,f){for(var c=0;c<f;c++){b[c+a]=g[c+d]}return b},arraytostr:function(a){var b="";for(var c=0;c<a.length;c++){b+=a[c]+" "}return b},arraytohexstr:function(a){var b="";for(var c=0;c<a.length;c++){b+=a[c].toString(16)+" "}return b},intar2bytear:function(a){var b=new Array();var d=0;for(var c=0;c<a.length;c++){b[d++]=((a[c]&4278190080)>>24)&255;b[d++]=((a[c]&16711680)>>16)&255;b[d++]=((a[c]&65280)>>8)&255;b[d++]=(a[c]&255)&255}return b},bytear2intar:function(b){var c=new Array();var f=0;for(var d=0;d<b.length;){var a=0;a|=(b[d++]<<24);a|=(b[d++]<<16);a|=(b[d++]<<8);a|=(b[d++]);c[f++]=a}return c},bytear2hexstr:function(a){var b="";for(var d=0;d<a.length;d++){var f=ArcotUtil.util_byte2hex(a[d]);if(f.length<2){f="0"+f}b+=f}return b},strToBytes:function(c){var a=new Array();for(var b=0;b<c.length;b++){a[b]=c.charCodeAt(b)}return a},alertlong:function(g){var b=g.split(/\r?\n/);var a=40;var f=0;var c="";for(var d=0;d<b.length;d++){if(d>0&&(d%a)==0){if(ArcotAIDMobile.debug){alert(c)}c=b[d]}else{c+="\n"+b[d]}}if(ArcotAIDMobile.debug){alert(c)}},calculate:function(n,m){form=document.forms.calcform;n=form.elements.bignum1.value;m=form.elements.bignum2.value;bignum3=form.elements.bignum3.value;var j=new ArcotJSBN.BigInteger(n,10);var i=new ArcotJSBN.BigInteger(m,10);var f=new ArcotJSBN.BigInteger(bignum3,10);var c=(ArcotAIDMobile.enddn.getMinutes()*60+ArcotAIDMobile.enddn.getSeconds())-(startdn.getMinutes()*60+startdn.getSeconds());form.elements.bn1bits.value=j.bitLength();form.elements.bn2bits.value=i.bitLength();form.elements.bn3bits.value=f.bitLength();var g=j.add(i);form.elements.sum.value=g;var l=j.subtract(i);form.elements.diff.value=l;var h=j.multiply(i);form.elements.prod.value=h;var k=new Date();var a=j.modPow(i,f);form.elements.modexp.value=a;var b=new Date();var d=(b.getMinutes()*60+b.getSeconds())-(k.getMinutes()*60+k.getSeconds());form.elements.calctime.value=d;form.elements.dntime.value=c;return true},ArcotWallet:function(){this.counter=0;this.walletversion;this.walletname;this.arcotcards=new Array();this.handlerobject=this},ArcotCard:function(a){this.parent=a;this.version;this.cardname;this.orgname;this.lastattr=null;this.counter=0;this.seqcount=0;this.arcotPrivateKey;this.plainPrivateKey;this.certificate;this.namedAttributes;this.handlerobject;this.dummyattribute},ArcotProtectedKey:function(a){this.parent=a;this.arcotDigest;this.camouflagedKey;this.camkeyoffset;this.camkeylength;this.counter=0;this.handlerobject},ArcotDigest:function(a){this.handlerobject;this.camouflageType;this.camouflageParameters;this.parent=a;this.counter=0},CamouflageParameters:function(a){this.parent=a;this.handlerobject;this.salt;this.iterationCount;this.checksum;this.span;this.start;this.counter=0},Name:function(a){this.parent=a;this.counter=0;this.handlerobject;this.hsParameters=new Array();this.seqcount=0;this.lastoid},nameHandleTag:function(b,a){if(this.handlerobject!=null&&this.handlerobject.handleTag!=undefined){this.handlerobject.handleTag(b,a);return}if(b=="SEQUENCE"){this.seqcount++}else{if(b=="ENDSEQUENCE"){this.seqcount--;if(this.seqcount<0){this.parent.notifyEnd()}}else{if(b=="OBJECTIDENTIFIER"){this.lastoid=a}else{if((b=="PrintableString"|b=="IA5String")&&this.lastoid!=null){this.hsParameters[this.lastoid]=a;this.lastoid=null}}}}},Certificate:function(a){this.parent=a;this.counter=0;this.handlerobject;this.version;this.serialnum;this.algorithmid;this.issuername;this.notbefore;this.notafter;this.subjectname;this.subjectkeytype;this.subjectpublickey;this.signatureAlgorithm;this.signature;this.rawdata;this.extseqcount=0},certHandleTag:function(b,a){if(this.handlerobject!=null&&this.handlerobject.handleTag!=undefined){this.handlerobject.handleTag(b,a);return}if(b=="INTEGER"&&this.counter==0){this.version=a;this.counter++}else{if(b=="INTEGER"&&this.counter==1){this.serialnum=a;this.counter++}else{if(b=="OBJECTIDENTIFIER"&&this.counter==2){this.algorithmid=a;this.counter++}else{if(b=="SEQUENCE"&&this.counter==3){this.issuername=new ArcotAIDMobile.Name(this);this.handlerobject=this.issuername;this.counter++}else{if(b=="UTCTime"&&this.counter==4){this.notbefore=a;this.counter++}else{if(b=="UTCTime"&&this.counter==5){this.notafter=a;this.counter++}else{if(b=="SEQUENCE"&&this.counter==6){this.subjectname=new ArcotAIDMobile.Name(this);this.handlerobject=this.subjectname;this.counter++}else{if(b=="OBJECTIDENTIFIER"&&this.counter==7){this.subjectkeytype=a;this.counter++}else{if(b=="BITSTRING"&&this.counter==8){this.subjectpublickey=a;this.counter++}else{if(b=="CONTEXTSPECIFIC"){}else{if(b=="SEQUENCE"&&this.counter==9){this.extseqcount++}else{if(b=="ENDSEQUENCE"&&this.counter==9){this.extseqcount--;if(this.extseqcount<=0){this.counter++}}else{if(b=="OBJECTIDENTIFIER"&&this.counter==10){this.signatureAlgorithm=a;this.counter++}else{if(b=="BITSTRING"&&this.counter==11){this.signature=a;this.counter++}else{if(b=="ENDSEQUENCE"&&this.counter==12){this.parent.notifyEnd()}else{if(b=="BITSTRING"&&this.counter==12){}else{}}}}}}}}}}}}}}}}},cparamsHandleTag:function(b,a){if(this.handlerobject!=null&&this.handlerobject.handleTag!=undefined){this.handlerobject.handleTag(b,a);return}if(b=="INTEGER"){if(this.counter==1){this.iterationCount=a;this.counter++}else{if(this.counter==2){this.checksum=a;this.counter++}else{if(this.counter==3){this.span=a;this.counter++}else{if(this.counter==4){this.start=a;this.counter++}}}}}else{if(b=="OCTETSTRING"){if(this.counter==0){this.salt=a;this.counter++}}else{if(b=="BITSTRING"){if(this.counter==2){this.checksum=a;this.counter++}}else{if(b=="SEQUENCE"){}else{if(b=="ENDSEQUENCE"){this.parent.notifyEnd()}}}}}},ardHandleTag:function(b,a){if(this.handlerobject!=null&&this.handlerobject.handleTag!=undefined){this.handlerobject.handleTag(b,a);return}if(b=="OBJECTIDENTIFIER"){this.camouflageType=a}else{if(b=="SEQUENCE"){if(this.counter==0){this.camouflageParameters=new ArcotAIDMobile.CamouflageParameters(this);this.handlerobject=this.camouflageParameters}}else{if(b=="ENDSEQUENCE"){this.parent.notifyEnd()}}}},apkHandleTag:function(c,b,a,d){if(this.handlerobject!=null&&this.handlerobject.handleTag!=undefined){this.handlerobject.handleTag(c,b);return}if(c=="SEQUENCE"){if(this.counter==0){this.counter++}else{if(this.counter==1){this.arcotDigest=new ArcotAIDMobile.ArcotDigest(this);this.handlerobject=this.arcotDigest}}}else{if(c=="ENDSEQUENCE"){this.parent.notifyEnd()}else{if(this.counter==2&&c=="OCTETSTRING"){this.camouflagedKey=b;this.camkeyoffset=d;this.camkeylength=a}}}},apkNotifyEnd:function(){this.handlerobject=null;this.counter++},ardNotifyEnd:function(){this.handlerobject=null;this.counter++;var a="digest details:\n";a+="camouflageType: "+this.camouflageType+"\n";a+="salt: "+this.camouflageParameters.salt+"\n";a+="iterationCount: "+this.camouflageParameters.iterationCount+"\n";a+="checksum: "+this.camouflageParameters.checksum+"\n";a+="span: "+this.camouflageParameters.span+"\n";a+="start: "+this.camouflageParameters.start},certNotifyEnd:function(){this.handlerobject=null},cparamsNotifyEnd:function(){this.handlerobject=null},arwNotifyEnd:function(){this.handlerobject=null},arcNotifyEnd:function(){this.handlerobject=null},nameNotifyEnd:function(){this.handlerobject=null},arcHandleTag:function(f,d,a,g){if(this.handlerobject!=null&&this.handlerobject.handleTag!=undefined){this.handlerobject.handleTag(f,d,a,g);return}if(this.counter==0&&f=="INTEGER"){this.version=d;this.counter++}else{if(this.counter==1&&f=="UTF8String"){this.cardname=d;this.counter++}else{if(f=="SEQUENCE"){this.seqcount++}else{if(f=="ENDSEQUENCE"){if(this.seqcount==0){this.parent.notifyEnd()}else{this.seqcount--}}else{if(f=="CONTEXTSPECIFIC"){if(d==0){var b=new ArcotAIDMobile.ArcotProtectedKey(this);this.arcotPrivateKey=b;this.handlerobject=b}else{if(d==1){}else{if(d==2){var c=new ArcotAIDMobile.Certificate(this);c.rawdata=ArcotASN1JS.lastcontextvalue;this.certificate=c;this.handlerobject=c}else{if(d==3){this.namedAttributes=new Array();this.counter=5}}}}}else{if(this.counter==5&&f=="IA5String"){this.lastattr=d}else{if(this.counter==5&&f=="OCTETSTRING"){if(this.lastattr!=null){if(this.lastattr=="Org"){this.orgname=ArcotUtil.util_hex2tstring(d)}this.namedAttributes[this.lastattr]=d;this.lastattr=null}}else{if(f=="OBJECTIDENTIFIER"){}else{}}}}}}}}},arwAddTag:function(d,c,b,a,f){if(this.handlerobject!=null){this.handlerobject.handleTag(d,c,a,f)}},arwHandleTag:function(b,a){if(this.counter==0&&b=="INTEGER"){this.walletversion=a;this.counter++}else{if(this.counter==1&&b=="UTF8String"){this.walletname=a;this.counter++}else{if(this.counter==2&&b=="SEQUENCE"){this.counter++}else{if(this.counter==3){if(b=="SEQUENCE"){this.arcotcards[this.arcotcards.length]=new ArcotAIDMobile.ArcotCard(this);this.handlerobject=this.arcotcards[this.arcotcards.length-1]}else{if(b=="ENDSEQUENCE"){this.counter++}}}else{}}}}}};ArcotAIDMobile.ArcotWallet.prototype.addTag=ArcotAIDMobile.arwAddTag;ArcotAIDMobile.ArcotWallet.prototype.notifyEnd=ArcotAIDMobile.arwNotifyEnd;ArcotAIDMobile.ArcotCard.prototype.notifyEnd=ArcotAIDMobile.arcNotifyEnd;ArcotAIDMobile.ArcotProtectedKey.prototype.notifyEnd=ArcotAIDMobile.apkNotifyEnd;ArcotAIDMobile.ArcotDigest.prototype.notifyEnd=ArcotAIDMobile.ardNotifyEnd;ArcotAIDMobile.CamouflageParameters.prototype.notifyEnd=ArcotAIDMobile.cparamsNotifyEnd;ArcotAIDMobile.Certificate.prototype.notifyEnd=ArcotAIDMobile.certNotifyEnd;ArcotAIDMobile.Name.prototype.notifyEnd=ArcotAIDMobile.nameNotifyEnd;ArcotAIDMobile.ArcotWallet.prototype.handleTag=ArcotAIDMobile.arwHandleTag;ArcotAIDMobile.ArcotCard.prototype.handleTag=ArcotAIDMobile.arcHandleTag;ArcotAIDMobile.ArcotProtectedKey.prototype.handleTag=ArcotAIDMobile.apkHandleTag;ArcotAIDMobile.ArcotDigest.prototype.handleTag=ArcotAIDMobile.ardHandleTag;ArcotAIDMobile.CamouflageParameters.prototype.handleTag=ArcotAIDMobile.cparamsHandleTag;ArcotAIDMobile.Certificate.prototype.handleTag=ArcotAIDMobile.certHandleTag;ArcotAIDMobile.Name.prototype.handleTag=ArcotAIDMobile.nameHandleTag;ArcotAIDMobile.enddn=new Date();ArcotAIDMobile.getCryptoType=function(a){if(a=="2.16.840.1.113862.9.1.1"){return 0}return -1};ArcotAIDMobile.ArcotDigestRep=function(d,a,c,g,f,b){this.oid=d;this.salt=a;this.iterations=c;this.phenc=g;this.start=f+0;this.span=b+0;this.cryptotype=ArcotAIDMobile.getCryptoType(this.oid)};ArcotAIDMobile.xorBits=function(d,k,g,j,f,a){var b=8;k[0]&=(255>>(f%b));var h=(~(255>>((f+a)%b))&255)&255;if(h!=0){k[j-1]&=h}for(var c=0;c<j;++c){d[g+c]^=k[c]}};ArcotAIDMobile.RSAKeyWrapper=function(){this.oid;this.octetstring;this.rsakey;this.count=0;this.handlerobject};ArcotAIDMobile.RSAKey=function(a){this.parent=a;this.exponent;this.modulus;this.count=0;this.octetstring;this.handlerobject};ArcotAIDMobile.rsakeywrapHandleTag=function(b,a){if(this.handlerobject!=null&&this.handlerobject.handleTag!=undefined){this.handlerobject.handleTag(b,a);return}if(b=="OBJECTIDENTIFIER"&&this.count==0){this.oid=a;this.count++}else{if(b=="OCTETSTRING"&&this.count==1){this.octetstring=a;this.octetstring=a;this.rsakey=new ArcotAIDMobile.RSAKey();this.rsakey.octetstring=this.octetstring;this.rsakey.parseKey();this.count++}}};ArcotAIDMobile.rsakeyParseKey=function(){var h=ArcotUtil.util_hex2bytearray(this.octetstring);var a=1<<7;var g=1;if((h[g]&a)==a){g+=h[g]&(a-1)}g++;g++;var c=0;if((h[g]&a)==a){var f=h[g]&(a-1);for(var b=0;b<f;b++){g++;c=((c<<8)|h[g])}g++}else{c=h[g++]}this.modulus=this.octetstring.substring(g*2,g*2+c*2);g+=c;if(h[g]!=2){return}g++;var d=0;if((h[g]&a)==a){var f=h[g]&(a-1);for(var b=0;b<f;b++){g++;d=((d<<8)|h[g])}g++}else{d=h[g++]}this.exponent=this.octetstring.substring(g*2,g*2+d*2)};ArcotAIDMobile.rsakeywrapAddTag=function(c,b,a){this.handleTag(c,b)};ArcotAIDMobile.rsakeyHandleTag=function(b,a){if(this.handlerobject!=null&&this.handlerobject.handleTag!=undefined){this.handlerobject.handleTag(b,a);return}if(b=="INTEGER"&&this.count==0){this.modulus=a;this.count++}else{if(b=="INTEGER"&&this.count==1){this.exponent=a;this.count++}else{if(b=="ENDSEQUENCE"&&this.count==1){this.exponent=a;this.count++}}}};ArcotAIDMobile.rsakeyAddTag=function(c,b,a){this.handleTag(c,b)};ArcotAIDMobile.RSAKeyWrapper.prototype.handleTag=ArcotAIDMobile.rsakeywrapHandleTag;ArcotAIDMobile.RSAKeyWrapper.prototype.addTag=ArcotAIDMobile.rsakeywrapAddTag;ArcotAIDMobile.RSAKey.prototype.parseKey=ArcotAIDMobile.rsakeyParseKey;ArcotAIDMobile.RSAKey.prototype.handleTag=ArcotAIDMobile.rsakeyHandleTag;ArcotAIDMobile.RSAKey.prototype.addTag=ArcotAIDMobile.rsakeyAddTag;ArcotAIDMobile.applyPinToKey=function(d,h){if(this.cryptotype==0){var b=(this.start/8)&4294967295;var c=(this.start+this.span+7)/8-b;d=unescape(encodeURIComponent(d));var f=ArcotCrypto.crypto_mgf1(d,c);var a=ArcotUtil.util_tstring2hex(f);var g=ArcotAIDMobile.hexstr2bytes(a);var i=h;ArcotAIDMobile.xorBits(i,g,b,c,this.start,this.span);return i}};ArcotAIDMobile.adrDecrypt=function(c,d){if(this.cryptotype==0){var b=this.applyPinToKey(c,d);var a=new ArcotAIDMobile.RSAKeyWrapper();ArcotASN1JS.decode(ArcotAIDMobile.bytear2hexstr(b),a);return a}};ArcotAIDMobile.ArcotDigestRep.prototype.decrypt=ArcotAIDMobile.adrDecrypt;ArcotAIDMobile.ArcotDigestRep.prototype.applyPinToKey=ArcotAIDMobile.applyPinToKey;ArcotAIDMobile.BitStringRep=function(){this.value=new Array()};ArcotAIDMobile.getBytesToSign=function(f){var c=new Array(48,9,6,5,43,14,3,2,26,5,0);var d=ArcotSHA1.core_sha1(ArcotAIDMobile.bytear2intar(f),f.length*8);d=ArcotAIDMobile.intar2bytear(d);var b=new Array(48,33,48,9,6,5,43,14,3,2,26,5,0,4,20);for(var a=0;a<d.length;a++){b[b.length]=d[a]}return b};ArcotAIDMobile.arcotsign=function(q,x,m){hlen=20;obits=q.bitLength()-1;obytes=((obits+7)/8)&(4294967295);t=8*obytes-obits;tmask=255>>t;var p=new Array();for(var u=0;u<8;u++){p[u]=0}var b=new Array();ArcotAIDMobile.fixedRandom(b,hlen);var r="salt is: ";for(var u=0;u<b.length;u++){r+=b[u]+" "}var g=new Array();ArcotAIDMobile.arraycopy(p,0,g,0,8);var w=m;ArcotAIDMobile.arraycopy(w,0,g,8,w.length);ArcotAIDMobile.arraycopy(b,0,g,g.length,b.length);var k=ArcotSHA1.core_sha1(ArcotAIDMobile.bytear2intar(g),g.length*8);k=ArcotAIDMobile.intar2bytear(k);var s=new Array();ArcotAIDMobile.arraycopy(b,0,s,obytes-hlen-1-b.length,b.length);s[obytes-hlen-1-b.length-1]=1;for(var u=0;u<(obytes-hlen-1-b.length-1);u++){s[u]=0}var f=ArcotUtil.util_hex2tstring(ArcotAIDMobile.bytear2hexstr(k));var l=ArcotCrypto.crypto_mgf1(f,s.length);var c=ArcotUtil.util_tstring2hex(l);var h=ArcotAIDMobile.hexstr2bytes(c);for(var u=0;u<h.length;++u){s[u]^=h[u]}s[0]&=tmask;var o=new Array();ArcotAIDMobile.arraycopy(s,0,o,0,s.length);ArcotAIDMobile.arraycopy(k,0,o,s.length,k.length);o[o.length]=188;var a=ArcotAIDMobile.bytear2hexstr(o);var y=new ArcotJSBN.BigInteger(a,16);var j=y.modPow(x,q);return j.toString(16)};ArcotAIDMobile.getLengthBytes=function(a){var c;if(a<128){c=new Array();c[0]=a}else{var g=1;var b=256;while(b<=a){b=b<<8;g++}var f=new Array();c=new Array();c[0]=(128|g);g--;while(a>0){f[g--]=a%256;a=a>>8}for(var d=0;d<f.length;d++){c[1+d]=f[d]}}return c};var ArcotASN1JS={};ArcotASN1JS.startdn=new Date();ArcotASN1JS.ID=new Array();ArcotASN1JS.NAME=new Array();ArcotASN1JS.ID.BOOLEAN=1;ArcotASN1JS.ID.INTEGER=2;ArcotASN1JS.ID.BITSTRING=3;ArcotASN1JS.ID.OCTETSTRING=4;ArcotASN1JS.ID.NULL=5;ArcotASN1JS.ID.OBJECTIDENTIFIER=6;ArcotASN1JS.ID.ObjectDescripter=7;ArcotASN1JS.ID.UTF8String=12;ArcotASN1JS.ID.SEQUENCE=16;ArcotASN1JS.ID.SET=17;ArcotASN1JS.ID.NumericString=18;ArcotASN1JS.ID.PrintableString=19;ArcotASN1JS.ID.TeletexString=20;ArcotASN1JS.ID.IA5String=22;ArcotASN1JS.ID.UTCTime=23;ArcotASN1JS.ID.GeneralizedTime=24;ArcotASN1JS.idx;for(ArcotASN1JS.idx in ArcotASN1JS.ID){ArcotASN1JS.NAME[ArcotASN1JS.ID[ArcotASN1JS.idx]]=ArcotASN1JS.idx}ArcotASN1JS.OID=new Array();ArcotASN1JS.TAB="                              ";ArcotASN1JS.TAB_num=-1;ArcotASN1JS.Bitstring_hex_limit=4;ArcotASN1JS.isEncode=new RegExp("[^0-9a-zA-Z/=+]","i");ArcotASN1JS.isB64=new RegExp("[^0-9a-fA-F]","i");ArcotASN1JS.convert=function(d,a,c){var b=d.value.replace(/[\s\r\n]/g,"");if(c=="auto"){if(b.match(ArcotASN1JS.isEncode)){c="encode"}else{if(b.match(ArcotASN1JS.isB64)){c="decode_B64"}else{c="decode_HEX"}}}if(c=="encode"){a.value=ArcotASN1JS.encode(b);return}else{if(c=="decode_B64"){if(b.match(ArcotASN1JS.isEncode)){if(confirm("Illegal character for Decoding process.\nDo you wish to continue as Encoding process?")){a.value=ArcotASN1JS.encode(b);return}else{return}}a.value=ArcotASN1JS.decode(ArcotASN1JS.bin2hex(ArcotASN1JS.base64decode(b)))}else{if(c=="decode_HEX"){if(b.match(ArcotASN1JS.isB64)){if(confirm("Illegal character for Decoding process.\nDo you wish to continue as Encoding process?")){a.value=ArcotASN1JS.encode(b);return}else{return}}a.value=ArcotASN1JS.decode(b)}}}};ArcotASN1JS.encode=function(b){var a;return a};ArcotASN1JS.lastcontextvalue;ArcotASN1JS.decode=function(b,a){if(b.length%2!=0){alert("Illegal length. Hex string's length must be even.")}return ArcotASN1JS.readASN1(b,a,0)};ArcotASN1JS.readASN1=function(q,a,f){var h=0;var i=0;var l=0;var p="";ArcotASN1JS.TAB_num++;while(h<q.length){var g=parseInt("0x"+q.substr(h,2));var k=g&32;var b=g&128;var r=g&31;var d=b?"["+r+"]":ArcotASN1JS.NAME[r];if(d==undefined){d="Unsupported_TAG"}h+=2;var j=0;if(r!=5){if(parseInt("0x"+q.substr(h,2))&128){var m=parseInt("0x"+q.substr(h,2))&127;if(m>4){var o="LENGTH field is too long.(at "+h+")\nThis program accepts up to 4 octets of Length field.";return o}j=parseInt("0x"+q.substr(h+2,m*2));h+=m*2+2}else{if(m!=0){j=parseInt("0x"+q.substr(h,2));h+=2}}if(j>q.length-h){var o="LENGTH is longer than the rest.\n";+"(LENGTH: "+j+", rest: "+q.length+")";return o}}else{h+=2}var s="";var c=ArcotASN1JS.TAB.substr(0,ArcotASN1JS.TAB_num*3);if(j){s=q.substr(h,j*2);if(k){i=h}else{l=h}h+=j*2}if(b){ArcotASN1JS.lastcontextvalue=s;a.addTag("CONTEXTSPECIFIC",r,h)}p+=c+d+" ";if(k){a.addTag("SEQUENCE",null,h);p+="{\n"+ArcotASN1JS.readASN1(s,a,f+i)+c+"}";a.addTag("ENDSEQUENCE",null,h)}else{var n=ArcotASN1JS.getValue(b?4:r,s);if(a!=null&&a.addTag!=undefined){a.addTag(d,n,h,f+l)}p+=n}p+="\n"}ArcotASN1JS.TAB_num--;return p};ArcotASN1JS.getValue=function(r,l){var n="";if(r==1){n=l?"TRUE":"FALSE"}else{if(r==2){n=parseInt("0x"+l)}else{if(r==3){var c=parseInt("0x"+l.substr(0,2));var q=l.substr(2);if(q.length>ArcotASN1JS.Bitstring_hex_limit){n="0x"+q}else{n=parseInt("0x"+q).toString(2)}n+=" : "+c+" unused bit(s)"}else{if(r==5){n=""}else{if(r==6){var o=new Array();var a=parseInt("0x"+l.substr(0,2));o[0]=Math.floor(a/40);o[1]=a-o[0]*40;var p=new Array();var b=0;var h;for(h=1;h<l.length-2;h=h+2){var d=parseInt("0x"+l.substr(h+1,2));p.push(d&127);if(d&128){b++}else{var g;var m=0;for(g=0;g<p.length;g++){m+=p[g]*Math.pow(128,b--)}o.push(m);b=0;p=new Array()}}n=o.join(".");if(ArcotASN1JS.OID[n]){n+=" ("+ArcotASN1JS.OID[n]+")"}}else{if(r==12){n=ArcotUtil.util_hex2str(l)}else{if(ArcotASN1JS.NAME[r].match(/(Time|String)$/)){var f=0;while(f<l.length){n+=String.fromCharCode("0x"+l.substr(f,2));f+=2}}else{n=l}}}}}}}return n};ArcotASN1JS.init_oid=function(b){var a=new Array();a=b.split(/\r?\n/);var d;for(d in a){var f=new Array();f=a[d].split(/,/);var c;for(c in f){f[c]=f[c].replace(/^\s+/);f[c]=f[c].replace(/\s+$/)}if(f.length<2||f[0].match(/^#/)){continue}if(f[0].match(/[^0-9\.\-\s]/)){ArcotASN1JS.OID[f[1]]=f[0]}else{ArcotASN1JS.OID[f[0]]=f[1]}}};ArcotASN1JS.bin2hex=function(d){var f="";var c=0;var a=d.length;while(c<a){var b=d.charCodeAt(c++).toString(16);if(b.length<2){f+="0"}f+=b}return f};ArcotASN1JS.base64chr=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);ArcotASN1JS.base64decode=function(j){var h,g,d,b;var f,a,c;a=j.length;f=0;c="";while(f<a){do{h=ArcotASN1JS.base64chr[j.charCodeAt(f++)&255]}while(f<a&&h==-1);if(h==-1){break}do{g=ArcotASN1JS.base64chr[j.charCodeAt(f++)&255]}while(f<a&&g==-1);if(g==-1){break}c+=String.fromCharCode((h<<2)|((g&48)>>4));do{d=j.charCodeAt(f++)&255;if(d==61){return c}d=ArcotASN1JS.base64chr[d]}while(f<a&&d==-1);if(d==-1){break}c+=String.fromCharCode(((g&15)<<4)|((d&60)>>2));do{b=j.charCodeAt(f++)&255;if(b==61){return c}b=ArcotASN1JS.base64chr[b]}while(f<a&&b==-1);if(b==-1){break}c+=String.fromCharCode(((d&3)<<6)|b)}return c};var ArcotBase64={b64map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64padding:"=",hex2b64:function(d){var b;var f;var a="";for(b=0;b+3<=d.length;b+=3){f=parseInt(d.substring(b,b+3),16);a+=ArcotBase64.b64map.charAt(f>>6)+ArcotBase64.b64map.charAt(f&63)}if(b+1==d.length){f=parseInt(d.substring(b,b+1),16);a+=ArcotBase64.b64map.charAt(f<<2)}else{if(b+2==d.length){f=parseInt(d.substring(b,b+2),16);a+=ArcotBase64.b64map.charAt(f>>2)+ArcotBase64.b64map.charAt((f&3)<<4)}}while((a.length&3)>0){a+=ArcotBase64.b64padding}return a},b64tohex:function(f){var c="";var d;var a=0;var b;for(d=0;d<f.length;++d){if(f.charAt(d)==ArcotBase64.b64padding){break}v=ArcotBase64.b64map.indexOf(f.charAt(d));if(v<0){continue}if(a==0){c+=ArcotJSBN.int2char(v>>2);b=v&3;a=1}else{if(a==1){c+=ArcotJSBN.int2char((b<<2)|(v>>4));b=v&15;a=2}else{if(a==2){c+=ArcotJSBN.int2char(b);c+=ArcotJSBN.int2char(v>>2);b=v&3;a=3}else{c+=ArcotJSBN.int2char((b<<2)|(v>>4));c+=ArcotJSBN.int2char(v&15);a=0}}}}if(a==1){c+=ArcotJSBN.int2char(b<<2)}return c},b64toBA:function(f){var d=ArcotBase64.b64tohex(f);var c;var b=new Array();for(c=0;2*c<d.length;++c){b[c]=parseInt(d.substring(2*c,2*c+2),16)}return b}};var ArcotCrypto={nullBlock:"0000000000000000",crypto_des:function(h,g,l,k,j,i){return des(h,g,l,k,j,i)},crypto_str_sha1:function(b){return ArcotSHA1.str_sha1(b)},crypto_X919Digest:function(k,j,g){if(g.length%8>0){g+=ArcotCrypto.nullBlock.substr(0,8-(g.length%8))}else{if(g.length==0){g=ArcotCrypto.nullBlock}}var l=ArcotUtil.util_hex2tstring(k);var a=ArcotUtil.util_hex2tstring(j);var i=ArcotUtil.util_hex2tstring(g);var d=ArcotUtil.util_hex2tstring(ArcotCrypto.nullBlock);var c=ArcotCrypto.crypto_des(l,i,1,1,d,3);var b=ArcotCrypto.crypto_des(a,c.substr(c.length-8,8),0,0);var f=ArcotCrypto.crypto_des(l,b,1,0);var h=ArcotUtil.util_tstring2hex(f);return h},crypto_mgf1:function(b,a){var h=new Array(4);var d;var c=0;var g="";for(var f=0;c<a;f++){h[0]=((f>>24)&255);h[1]=((f>>16)&255);h[2]=((f>>8)&255);h[3]=(f&255);cntstr=String.fromCharCode(h[0])+String.fromCharCode(h[1])+String.fromCharCode(h[2])+String.fromCharCode(h[3]);d=ArcotCrypto.crypto_str_sha1(b+cntstr);if(c+d.length>a){g+=d.substr(0,a-c);c=a}else{g+=d;c+=d.length}}return g}};var ArcotJSBN={};ArcotJSBN.dbits;ArcotJSBN.canary=244837814094590;ArcotJSBN.j_lm=((ArcotJSBN.canary&16777215)==15715070);ArcotJSBN.BigInteger=function(f,d,g){if(f!=null){if("number"==typeof f){this.fromNumber(f,d,g)}else{if(d==null&&"string"!=typeof f){this.fromString(f,256)}else{this.fromString(f,d)}}}};ArcotJSBN.nbi=function(){return new ArcotJSBN.BigInteger(null)};ArcotJSBN.am1=function(g,a,b,f,k,h){while(--h>=0){var d=a*this[g++]+b[f]+k;k=Math.floor(d/67108864);b[f++]=d&67108863}return k};ArcotJSBN.am2=function(g,r,s,f,p,a){var o=r&32767,q=r>>15;while(--a>=0){var d=this[g]&32767;var k=this[g++]>>15;var b=q*d+k*o;d=o*d+((b&32767)<<15)+s[f]+(p&1073741823);p=(d>>>30)+(b>>>15)+q*k+(p>>>30);s[f++]=d&1073741823}return p};ArcotJSBN.am3=function(g,r,s,f,p,a){var o=r&16383,q=r>>14;while(--a>=0){var d=this[g]&16383;var k=this[g++]>>14;var b=q*d+k*o;d=o*d+((b&16383)<<14)+s[f]+p;p=(d>>28)+(b>>14)+q*k;s[f++]=d&268435455}return p};if(ArcotJSBN.j_lm&&(navigator.appName=="Microsoft Internet Explorer")){ArcotJSBN.BigInteger.prototype.am=ArcotJSBN.am2;ArcotJSBN.dbits=30}else{if(ArcotJSBN.j_lm&&(navigator.appName!="Netscape")){ArcotJSBN.BigInteger.prototype.am=ArcotJSBN.am1;ArcotJSBN.dbits=26}else{if(ArcotJSBN.j_lm&&(navigator.appName!="BlackBerry")){ArcotJSBN.BigInteger.prototype.am=ArcotJSBN.am2;ArcotJSBN.dbits=30}else{ArcotJSBN.BigInteger.prototype.am=ArcotJSBN.am3;ArcotJSBN.dbits=28}}}ArcotJSBN.BigInteger.prototype.DB=ArcotJSBN.dbits;ArcotJSBN.BigInteger.prototype.DM=((1<<ArcotJSBN.dbits)-1);ArcotJSBN.BigInteger.prototype.DV=(1<<ArcotJSBN.dbits);ArcotJSBN.BI_FP=52;ArcotJSBN.BigInteger.prototype.FV=Math.pow(2,ArcotJSBN.BI_FP);ArcotJSBN.BigInteger.prototype.F1=ArcotJSBN.BI_FP-ArcotJSBN.dbits;ArcotJSBN.BigInteger.prototype.F2=2*ArcotJSBN.dbits-ArcotJSBN.BI_FP;ArcotJSBN.BI_RM="0123456789abcdefghijklmnopqrstuvwxyz";ArcotJSBN.BI_RC=new Array();ArcotJSBN.rr;ArcotJSBN.vv;ArcotJSBN.rr="0".charCodeAt(0);for(ArcotJSBN.vv=0;ArcotJSBN.vv<=9;++ArcotJSBN.vv){ArcotJSBN.BI_RC[ArcotJSBN.rr++]=ArcotJSBN.vv}ArcotJSBN.rr="a".charCodeAt(0);for(ArcotJSBN.vv=10;ArcotJSBN.vv<36;++ArcotJSBN.vv){ArcotJSBN.BI_RC[ArcotJSBN.rr++]=ArcotJSBN.vv}ArcotJSBN.rr="A".charCodeAt(0);for(ArcotJSBN.vv=10;ArcotJSBN.vv<36;++ArcotJSBN.vv){ArcotJSBN.BI_RC[ArcotJSBN.rr++]=ArcotJSBN.vv}ArcotJSBN.int2char=function(a){return ArcotJSBN.BI_RM.charAt(a)};ArcotJSBN.intAt=function(b,a){ArcotJSBN.c=ArcotJSBN.BI_RC[b.charCodeAt(a)];return(ArcotJSBN.c==null)?-1:ArcotJSBN.c};ArcotJSBN.bnpCopyTo=function(b){for(var a=this.t-1;a>=0;--a){b[a]=this[a]}b.t=this.t;b.s=this.s};ArcotJSBN.bnpFromInt=function(a){this.t=1;this.s=(a<0)?-1:0;if(a>0){this[0]=a}else{if(a<-1){this[0]=a+DV}else{this.t=0}}};ArcotJSBN.nbv=function(a){var b=ArcotJSBN.nbi();b.fromInt(a);return b};ArcotJSBN.bnpFromString=function(j,c){var f;if(c==16){f=4}else{if(c==8){f=3}else{if(c==256){f=8}else{if(c==2){f=1}else{if(c==32){f=5}else{if(c==4){f=2}else{this.fromRadix(j,c);return}}}}}}this.t=0;this.s=0;var h=j.length,d=false,g=0;while(--h>=0){var a=(f==8)?j[h]&255:ArcotJSBN.intAt(j,h);if(a<0){if(j.charAt(h)=="-"){d=true}continue}d=false;if(g==0){this[this.t++]=a}else{if(g+f>this.DB){this[this.t-1]|=(a&((1<<(this.DB-g))-1))<<g;this[this.t++]=(a>>(this.DB-g))}else{this[this.t-1]|=a<<g}}g+=f;if(g>=this.DB){g-=this.DB}}if(f==8&&(j[0]&128)!=0){this.s=-1;if(g>0){this[this.t-1]|=((1<<(this.DB-g))-1)<<g}}this.clamp();if(d){ArcotJSBN.BigInteger.ZERO.subTo(this,this)}};ArcotJSBN.bnpClamp=function(){var a=this.s&this.DM;while(this.t>0&&this[this.t-1]==a){--this.t}};ArcotJSBN.bnToString=function(c){if(this.s<0){return"-"+this.negate().toString(c)}var f;if(c==16){f=4}else{if(c==8){f=3}else{if(c==2){f=1}else{if(c==32){f=5}else{if(c==4){f=2}else{return this.toRadix(c)}}}}}var h=(1<<f)-1,n,a=false,j="",g=this.t;var l=this.DB-(g*this.DB)%f;if(g-->0){if(l<this.DB&&(n=this[g]>>l)>0){a=true;j=ArcotJSBN.int2char(n)}while(g>=0){if(l<f){n=(this[g]&((1<<l)-1))<<(f-l);n|=this[--g]>>(l+=this.DB-f)}else{n=(this[g]>>(l-=f))&h;if(l<=0){l+=this.DB;--g}}if(n>0){a=true}if(a){j+=ArcotJSBN.int2char(n)}}}return a?j:"0"};ArcotJSBN.bnNegate=function(){var a=ArcotJSBN.nbi();ArcotJSBN.BigInteger.ZERO.subTo(this,a);return a};ArcotJSBN.bnAbs=function(){return(this.s<0)?this.negate():this};ArcotJSBN.bnCompareTo=function(b){var d=this.s-b.s;if(d!=0){return d}var c=this.t;d=c-b.t;if(d!=0){return d}while(--c>=0){if((d=this[c]-b[c])!=0){return d}}return 0};ArcotJSBN.nbits=function(a){var c=1,b;if((b=a>>>16)!=0){a=b;c+=16}if((b=a>>8)!=0){a=b;c+=8}if((b=a>>4)!=0){a=b;c+=4}if((b=a>>2)!=0){a=b;c+=2}if((b=a>>1)!=0){a=b;c+=1}return c};ArcotJSBN.bnBitLength=function(){if(this.t<=0){return 0}return this.DB*(this.t-1)+ArcotJSBN.nbits(this[this.t-1]^(this.s&this.DM))};ArcotJSBN.bnpDLShiftTo=function(c,b){var a;for(a=this.t-1;a>=0;--a){b[a+c]=this[a]}for(a=c-1;a>=0;--a){b[a]=0}b.t=this.t+c;b.s=this.s};ArcotJSBN.bnpDRShiftTo=function(c,b){for(var a=c;a<this.t;++a){b[a-c]=this[a]}b.t=Math.max(this.t-c,0);b.s=this.s};ArcotJSBN.bnpLShiftTo=function(k,f){var b=k%this.DB;var a=this.DB-b;var h=(1<<a)-1;var g=Math.floor(k/this.DB),j=(this.s<<b)&this.DM,d;for(d=this.t-1;d>=0;--d){f[d+g+1]=(this[d]>>a)|j;j=(this[d]&h)<<b}for(d=g-1;d>=0;--d){f[d]=0}f[g]=j;f.t=this.t+g+1;f.s=this.s;f.clamp()};ArcotJSBN.bnpRShiftTo=function(h,d){d.s=this.s;var f=Math.floor(h/this.DB);if(f>=this.t){d.t=0;return}var b=h%this.DB;var a=this.DB-b;var g=(1<<b)-1;d[0]=this[f]>>b;for(var c=f+1;c<this.t;++c){d[c-f-1]|=(this[c]&g)<<a;d[c-f]=this[c]>>b}if(b>0){d[this.t-f-1]|=(this.s&g)<<a}d.t=this.t-f;d.clamp()};ArcotJSBN.bnpSubTo=function(d,g){var f=0,h=0,b=Math.min(d.t,this.t);while(f<b){h+=this[f]-d[f];g[f++]=h&this.DM;h>>=this.DB}if(d.t<this.t){h-=d.s;while(f<this.t){h+=this[f];g[f++]=h&this.DM;h>>=this.DB}h+=this.s}else{h+=this.s;while(f<d.t){h-=d[f];g[f++]=h&this.DM;h>>=this.DB}h-=d.s}g.s=(h<0)?-1:0;if(h<-1){g[f++]=this.DV+h}else{if(h>0){g[f++]=h}}g.t=f;g.clamp()};ArcotJSBN.bnpMultiplyTo=function(c,f){var b=this.abs(),g=c.abs();var d=b.t;f.t=d+g.t;while(--d>=0){f[d]=0}for(d=0;d<g.t;++d){f[d+b.t]=b.am(0,g[d],f,d,0,b.t)}f.s=0;f.clamp();if(this.s!=c.s){ArcotJSBN.BigInteger.ZERO.subTo(f,f)}};ArcotJSBN.bnpSquareTo=function(d){var a=this.abs();var b=d.t=2*a.t;while(--b>=0){d[b]=0}for(b=0;b<a.t-1;++b){var f=a.am(b,a[b],d,2*b,0,1);if((d[b+a.t]+=a.am(b+1,2*a[b],d,2*b+1,f,a.t-b-1))>=a.DV){d[b+a.t]-=a.DV;d[b+a.t+1]=1}}if(d.t>0){d[d.t-1]+=a.am(b,a[b],d,2*b,0,1)}d.s=0;d.clamp()};ArcotJSBN.bnpDivRemTo=function(n,h,g){var x=n.abs();if(x.t<=0){return}var k=this.abs();if(k.t<x.t){if(h!=null){h.fromInt(0)}if(g!=null){this.copyTo(g)}return}if(g==null){g=ArcotJSBN.nbi()}var d=ArcotJSBN.nbi(),a=this.s,l=n.s;var w=this.DB-ArcotJSBN.nbits(x[x.t-1]);if(w>0){x.lShiftTo(w,d);k.lShiftTo(w,g)}else{x.copyTo(d);k.copyTo(g)}var p=d.t;var b=d[p-1];if(b==0){return}var o=b*(1<<this.F1)+((p>1)?d[p-2]>>this.F2:0);var B=this.FV/o,A=(1<<this.F1)/o,z=1<<this.F2;var u=g.t,s=u-p,f=(h==null)?ArcotJSBN.nbi():h;d.dlShiftTo(s,f);if(g.compareTo(f)>=0){g[g.t++]=1;g.subTo(f,g)}ArcotJSBN.BigInteger.ONE.dlShiftTo(p,f);f.subTo(d,d);while(d.t<p){d[d.t++]=0}while(--s>=0){var c=(g[--u]==b)?this.DM:Math.floor(g[u]*B+(g[u-1]+z)*A);if((g[u]+=d.am(0,c,g,s,0,p))<c){d.dlShiftTo(s,f);g.subTo(f,g);while(g[u]<--c){g.subTo(f,g)}}}if(h!=null){g.drShiftTo(p,h);if(a!=l){ArcotJSBN.BigInteger.ZERO.subTo(h,h)}}g.t=p;g.clamp();if(w>0){g.rShiftTo(w,g)}if(a<0){ArcotJSBN.BigInteger.ZERO.subTo(g,g)}};ArcotJSBN.bnMod=function(b){var c=ArcotJSBN.nbi();this.abs().divRemTo(b,null,c);if(this.s<0&&c.compareTo(ArcotJSBN.BigInteger.ZERO)>0){b.subTo(c,c)}return c};ArcotJSBN.Classic=function(a){this.m=a};ArcotJSBN.cConvert=function(a){if(a.s<0||a.compareTo(this.m)>=0){return a.mod(this.m)}else{return a}};ArcotJSBN.cRevert=function(a){return a};ArcotJSBN.cReduce=function(a){a.divRemTo(this.m,null,a)};ArcotJSBN.cMulTo=function(a,c,b){a.multiplyTo(c,b);this.reduce(b)};ArcotJSBN.cSqrTo=function(a,b){a.squareTo(b);this.reduce(b)};ArcotJSBN.Classic.prototype.convert=ArcotJSBN.cConvert;ArcotJSBN.Classic.prototype.revert=ArcotJSBN.cRevert;ArcotJSBN.Classic.prototype.reduce=ArcotJSBN.cReduce;ArcotJSBN.Classic.prototype.mulTo=ArcotJSBN.cMulTo;ArcotJSBN.Classic.prototype.sqrTo=ArcotJSBN.cSqrTo;ArcotJSBN.bnpInvDigit=function(){if(this.t<1){return 0}var a=this[0];if((a&1)==0){return 0}var b=a&3;b=(b*(2-(a&15)*b))&15;b=(b*(2-(a&255)*b))&255;b=(b*(2-(((a&65535)*b)&65535)))&65535;b=(b*(2-a*b%this.DV))%this.DV;return(b>0)?this.DV-b:-b};ArcotJSBN.Montgomery=function(a){this.m=a;this.mp=a.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(a.DB-15))-1;this.mt2=2*a.t};ArcotJSBN.montConvert=function(a){var b=ArcotJSBN.nbi();a.abs().dlShiftTo(this.m.t,b);b.divRemTo(this.m,null,b);if(a.s<0&&b.compareTo(ArcotJSBN.BigInteger.ZERO)>0){this.m.subTo(b,b)}return b};ArcotJSBN.montRevert=function(a){var b=ArcotJSBN.nbi();a.copyTo(b);this.reduce(b);return b};ArcotJSBN.montReduce=function(a){while(a.t<=this.mt2){a[a.t++]=0}for(var c=0;c<this.m.t;++c){var b=a[c]&32767;var d=(b*this.mpl+(((b*this.mph+(a[c]>>15)*this.mpl)&this.um)<<15))&a.DM;b=c+this.m.t;a[b]+=this.m.am(0,d,a,c,0,this.m.t);while(a[b]>=a.DV){a[b]-=a.DV;a[++b]++}}a.clamp();a.drShiftTo(this.m.t,a);if(a.compareTo(this.m)>=0){a.subTo(this.m,a)}};ArcotJSBN.montSqrTo=function(a,b){a.squareTo(b);this.reduce(b)};ArcotJSBN.montMulTo=function(a,c,b){a.multiplyTo(c,b);this.reduce(b)};ArcotJSBN.Montgomery.prototype.convert=ArcotJSBN.montConvert;ArcotJSBN.Montgomery.prototype.revert=ArcotJSBN.montRevert;ArcotJSBN.Montgomery.prototype.reduce=ArcotJSBN.montReduce;ArcotJSBN.Montgomery.prototype.mulTo=ArcotJSBN.montMulTo;ArcotJSBN.Montgomery.prototype.sqrTo=ArcotJSBN.montSqrTo;ArcotJSBN.bnpIsEven=function(){return((this.t>0)?(this[0]&1):this.s)==0};ArcotJSBN.bnpExp=function(h,j){if(h>4294967295||h<1){return ArcotJSBN.BigInteger.ONE}var f=ArcotJSBN.nbi(),a=ArcotJSBN.nbi(),d=j.convert(this),c=ArcotJSBN.nbits(h)-1;d.copyTo(f);while(--c>=0){j.sqrTo(f,a);if((h&(1<<c))>0){j.mulTo(a,d,f)}else{var b=f;f=a;a=b}}return j.revert(f)};ArcotJSBN.bnModPowInt=function(b,a){var c;if(b<256||a.isEven()){c=new ArcotJSBN.Classic(a)}else{c=new ArcotJSBN.Montgomery(a)}return this.exp(b,c)};ArcotJSBN.BigInteger.prototype.copyTo=ArcotJSBN.bnpCopyTo;ArcotJSBN.BigInteger.prototype.fromInt=ArcotJSBN.bnpFromInt;ArcotJSBN.BigInteger.prototype.fromString=ArcotJSBN.bnpFromString;ArcotJSBN.BigInteger.prototype.clamp=ArcotJSBN.bnpClamp;ArcotJSBN.BigInteger.prototype.dlShiftTo=ArcotJSBN.bnpDLShiftTo;ArcotJSBN.BigInteger.prototype.drShiftTo=ArcotJSBN.bnpDRShiftTo;ArcotJSBN.BigInteger.prototype.lShiftTo=ArcotJSBN.bnpLShiftTo;ArcotJSBN.BigInteger.prototype.rShiftTo=ArcotJSBN.bnpRShiftTo;ArcotJSBN.BigInteger.prototype.subTo=ArcotJSBN.bnpSubTo;ArcotJSBN.BigInteger.prototype.multiplyTo=ArcotJSBN.bnpMultiplyTo;ArcotJSBN.BigInteger.prototype.squareTo=ArcotJSBN.bnpSquareTo;ArcotJSBN.BigInteger.prototype.divRemTo=ArcotJSBN.bnpDivRemTo;ArcotJSBN.BigInteger.prototype.invDigit=ArcotJSBN.bnpInvDigit;ArcotJSBN.BigInteger.prototype.isEven=ArcotJSBN.bnpIsEven;ArcotJSBN.BigInteger.prototype.exp=ArcotJSBN.bnpExp;ArcotJSBN.BigInteger.prototype.toString=ArcotJSBN.bnToString;ArcotJSBN.BigInteger.prototype.negate=ArcotJSBN.bnNegate;ArcotJSBN.BigInteger.prototype.abs=ArcotJSBN.bnAbs;ArcotJSBN.BigInteger.prototype.compareTo=ArcotJSBN.bnCompareTo;ArcotJSBN.BigInteger.prototype.bitLength=ArcotJSBN.bnBitLength;ArcotJSBN.BigInteger.prototype.mod=ArcotJSBN.bnMod;ArcotJSBN.BigInteger.prototype.modPowInt=ArcotJSBN.bnModPowInt;ArcotJSBN.BigInteger.ZERO=ArcotJSBN.nbv(0);ArcotJSBN.BigInteger.ONE=ArcotJSBN.nbv(1);ArcotJSBN.bnClone=function(){var a=ArcotJSBN.nbi();this.copyTo(a);return a};ArcotJSBN.bnIntValue=function(){if(this.s<0){if(this.t==1){return this[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0]};ArcotJSBN.bnByteValue=function(){return(this.t==0)?this.s:(this[0]<<24)>>24};ArcotJSBN.bnShortValue=function(){return(this.t==0)?this.s:(this[0]<<16)>>16};ArcotJSBN.bnpChunkSize=function(a){return Math.floor(Math.LN2*this.DB/Math.log(a))};ArcotJSBN.bnSigNum=function(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}};ArcotJSBN.bnpToRadix=function(c){if(c==null){c=10}if(this.signum()==0||c<2||c>36){return"0"}var g=this.chunkSize(c);var f=Math.pow(c,g);var j=ArcotJSBN.nbv(f),k=ArcotJSBN.nbi(),i=ArcotJSBN.nbi(),h="";this.divRemTo(j,k,i);while(k.signum()>0){h=(f+i.intValue()).toString(c).substr(1)+h;k.divRemTo(j,k,i)}return i.intValue().toString(c)+h};ArcotJSBN.bnpFromRadix=function(n,k){this.fromInt(0);if(k==null){k=10}var g=this.chunkSize(k);var h=Math.pow(k,g),f=false,a=0,m=0;for(var c=0;c<n.length;++c){var l=ArcotJSBN.intAt(n,c);if(l<0){if(n.charAt(c)=="-"&&this.signum()==0){f=true}continue}m=k*m+l;if(++a>=g){this.dMultiply(h);this.dAddOffset(m,0);a=0;m=0}}if(a>0){this.dMultiply(Math.pow(k,a));this.dAddOffset(m,0)}if(f){ArcotJSBN.BigInteger.ZERO.subTo(this,this)}};ArcotJSBN.bnpFromNumber=function(g,f,i){if("number"==typeof f){if(g<2){this.fromInt(1)}else{this.fromNumber(g,i);if(!this.testBit(g-1)){this.bitwiseTo(ArcotJSBN.BigInteger.ONE.shiftLeft(g-1),ArcotJSBN.op_or,this)}if(this.isEven()){this.dAddOffset(1,0)}while(!this.isProbablePrime(f)){this.dAddOffset(2,0);if(this.bitLength()>g){this.subTo(ArcotJSBN.BigInteger.ONE.shiftLeft(g-1),this)}}}}else{var d=new Array(),h=g&7;d.length=(g>>3)+1;f.nextBytes(d);if(h>0){d[0]&=((1<<h)-1)}else{d[0]=0}this.fromString(d,256)}};ArcotJSBN.bnToByteArray=function(){var b=this.t,c=new Array();c[0]=this.s;var f=this.DB-(b*this.DB)%8,g,a=0;if(b-->0){if(f<this.DB&&(g=this[b]>>f)!=(this.s&this.DM)>>f){c[a++]=g|(this.s<<(this.DB-f))}while(b>=0){if(f<8){g=(this[b]&((1<<f)-1))<<(8-f);g|=this[--b]>>(f+=this.DB-8)}else{g=(this[b]>>(f-=8))&255;if(f<=0){f+=this.DB;--b}}if((g&128)!=0){g|=-256}if(a==0&&(this.s&128)!=(g&128)){++a}if(a>0||g!=this.s){c[a++]=g}}}return c};ArcotJSBN.bnEquals=function(b){return(this.compareTo(b)==0)};ArcotJSBN.bnMin=function(b){return(this.compareTo(b)<0)?this:b};ArcotJSBN.bnMax=function(b){return(this.compareTo(b)>0)?this:b};ArcotJSBN.bnpBitwiseTo=function(c,j,g){var d,h,b=Math.min(c.t,this.t);for(d=0;d<b;++d){g[d]=j(this[d],c[d])}if(c.t<this.t){h=c.s&this.DM;for(d=b;d<this.t;++d){g[d]=j(this[d],h)}g.t=this.t}else{h=this.s&this.DM;for(d=b;d<c.t;++d){g[d]=j(h,c[d])}g.t=c.t}g.s=j(this.s,c.s);g.clamp()};ArcotJSBN.op_and=function(a,b){return a&b};ArcotJSBN.bnAnd=function(b){var c=ArcotJSBN.nbi();this.bitwiseTo(b,ArcotJSBN.op_and,c);return c};ArcotJSBN.op_or=function(a,b){return a|b};ArcotJSBN.bnOr=function(b){var c=ArcotJSBN.nbi();this.bitwiseTo(b,ArcotJSBN.op_or,c);return c};ArcotJSBN.op_xor=function(a,b){return a^b};ArcotJSBN.bnXor=function(b){var c=ArcotJSBN.nbi();this.bitwiseTo(b,ArcotJSBN.op_xor,c);return c};ArcotJSBN.op_andnot=function(a,b){return a&~b};ArcotJSBN.bnAndNot=function(b){var c=ArcotJSBN.nbi();this.bitwiseTo(b,ArcotJSBN.op_andnot,c);return c};ArcotJSBN.bnNot=function(){var b=ArcotJSBN.nbi();for(var a=0;a<this.t;++a){b[a]=this.DM&~this[a]}b.t=this.t;b.s=~this.s;return b};ArcotJSBN.bnShiftLeft=function(b){var a=ArcotJSBN.nbi();if(b<0){this.rShiftTo(-b,a)}else{this.lShiftTo(b,a)}return a};ArcotJSBN.bnShiftRight=function(b){var a=ArcotJSBN.nbi();if(b<0){this.lShiftTo(-b,a)}else{this.rShiftTo(b,a)}return a};ArcotJSBN.lbit=function(a){if(a==0){return -1}var b=0;if((a&65535)==0){a>>=16;b+=16}if((a&255)==0){a>>=8;b+=8}if((a&15)==0){a>>=4;b+=4}if((a&3)==0){a>>=2;b+=2}if((a&1)==0){++b}return b};ArcotJSBN.bnGetLowestSetBit=function(){for(var a=0;a<this.t;++a){if(this[a]!=0){return a*this.DB+ArcotJSBN.lbit(this[a])}}if(this.s<0){return this.t*this.DB}return -1};ArcotJSBN.cbit=function(a){var b=0;while(a!=0){a&=a-1;++b}return b};ArcotJSBN.bnBitCount=function(){var c=0,a=this.s&this.DM;for(var b=0;b<this.t;++b){c+=ArcotJSBN.cbit(this[b]^a)}return c};ArcotJSBN.bnTestBit=function(b){var a=Math.floor(b/this.DB);if(a>=this.t){return(this.s!=0)}return((this[a]&(1<<(b%this.DB)))!=0)};ArcotJSBN.bnpChangeBit=function(c,b){var a=ArcotJSBN.BigInteger.ONE.shiftLeft(c);this.bitwiseTo(a,b,a);return a};ArcotJSBN.bnSetBit=function(a){return this.changeBit(a,ArcotJSBN.op_or)};ArcotJSBN.bnClearBit=function(a){return this.changeBit(a,ArcotJSBN.op_andnot)};ArcotJSBN.bnFlipBit=function(a){return this.changeBit(a,ArcotJSBN.op_xor)};ArcotJSBN.bnpAddTo=function(d,g){var f=0,h=0,b=Math.min(d.t,this.t);while(f<b){h+=this[f]+d[f];g[f++]=h&this.DM;h>>=this.DB}if(d.t<this.t){h+=d.s;while(f<this.t){h+=this[f];g[f++]=h&this.DM;h>>=this.DB}h+=this.s}else{h+=this.s;while(f<d.t){h+=d[f];g[f++]=h&this.DM;h>>=this.DB}h+=d.s}g.s=(h<0)?-1:0;if(h>0){g[f++]=h}else{if(h<-1){g[f++]=this.DV+h}}g.t=f;g.clamp()};ArcotJSBN.bnAdd=function(b){var c=ArcotJSBN.nbi();this.addTo(b,c);return c};ArcotJSBN.bnSubtract=function(b){var c=ArcotJSBN.nbi();this.subTo(b,c);return c};ArcotJSBN.bnMultiply=function(b){var c=ArcotJSBN.nbi();this.multiplyTo(b,c);return c};ArcotJSBN.bnDivide=function(b){var c=ArcotJSBN.nbi();this.divRemTo(b,c,null);return c};ArcotJSBN.bnRemainder=function(b){var c=ArcotJSBN.nbi();this.divRemTo(b,null,c);return c};ArcotJSBN.bnDivideAndRemainder=function(b){var d=ArcotJSBN.nbi(),c=ArcotJSBN.nbi();this.divRemTo(b,d,c);return new Array(d,c)};ArcotJSBN.bnpDMultiply=function(a){this[this.t]=this.am(0,a-1,this,0,0,this.t);++this.t;this.clamp()};ArcotJSBN.bnpDAddOffset=function(b,a){while(this.t<=a){this[this.t++]=0}this[a]+=b;while(this[a]>=this.DV){this[a]-=this.DV;if(++a>=this.t){this[this.t++]=0}++this[a]}};ArcotJSBN.NullExp=function(){};ArcotJSBN.nNop=function(a){return a};ArcotJSBN.nMulTo=function(a,c,b){a.multiplyTo(c,b)};ArcotJSBN.nSqrTo=function(a,b){a.squareTo(b)};ArcotJSBN.NullExp.prototype.convert=ArcotJSBN.nNop;ArcotJSBN.NullExp.prototype.revert=ArcotJSBN.nNop;ArcotJSBN.NullExp.prototype.mulTo=ArcotJSBN.nMulTo;ArcotJSBN.NullExp.prototype.sqrTo=ArcotJSBN.nSqrTo;ArcotJSBN.bnPow=function(a){return this.exp(a,new ArcotJSBN.NullExp())};ArcotJSBN.bnpMultiplyLowerTo=function(b,g,f){var d=Math.min(this.t+b.t,g);f.s=0;f.t=d;while(d>0){f[--d]=0}var c;for(c=f.t-this.t;d<c;++d){f[d+this.t]=this.am(0,b[d],f,d,0,this.t)}for(c=Math.min(b.t,g);d<c;++d){this.am(0,b[d],f,d,0,g-d)}f.clamp()};ArcotJSBN.bnpMultiplyUpperTo=function(b,f,d){--f;var c=d.t=this.t+b.t-f;d.s=0;while(--c>=0){d[c]=0}for(c=Math.max(f-this.t,0);c<b.t;++c){d[this.t+c-f]=this.am(f-c,b[c],d,0,0,this.t+c-f)}d.clamp();d.drShiftTo(1,d)};ArcotJSBN.Barrett=function(a){this.r2=ArcotJSBN.nbi();this.q3=ArcotJSBN.nbi();ArcotJSBN.BigInteger.ONE.dlShiftTo(2*a.t,this.r2);this.mu=this.r2.divide(a);this.m=a};ArcotJSBN.barrettConvert=function(a){if(a.s<0||a.t>2*this.m.t){return a.mod(this.m)}else{if(a.compareTo(this.m)<0){return a}else{var b=ArcotJSBN.nbi();a.copyTo(b);this.reduce(b);return b}}};ArcotJSBN.barrettRevert=function(a){return a};ArcotJSBN.barrettReduce=function(a){a.drShiftTo(this.m.t-1,this.r2);if(a.t>this.m.t+1){a.t=this.m.t+1;a.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(a.compareTo(this.r2)<0){a.dAddOffset(1,this.m.t+1)}a.subTo(this.r2,a);while(a.compareTo(this.m)>=0){a.subTo(this.m,a)}};ArcotJSBN.barrettSqrTo=function(a,b){a.squareTo(b);this.reduce(b)};ArcotJSBN.barrettMulTo=function(a,c,b){a.multiplyTo(c,b);this.reduce(b)};ArcotJSBN.Barrett.prototype.convert=ArcotJSBN.barrettConvert;ArcotJSBN.Barrett.prototype.revert=ArcotJSBN.barrettRevert;ArcotJSBN.Barrett.prototype.reduce=ArcotJSBN.barrettReduce;ArcotJSBN.Barrett.prototype.mulTo=ArcotJSBN.barrettMulTo;ArcotJSBN.Barrett.prototype.sqrTo=ArcotJSBN.barrettSqrTo;ArcotJSBN.bnModPow=function(s,f){var o=s.bitLength(),h,b=ArcotJSBN.nbv(1),y;if(o<=0){return b}else{if(o<18){h=1}else{if(o<48){h=3}else{if(o<144){h=4}else{if(o<768){h=5}else{h=6}}}}}if(o<8){y=new ArcotJSBN.Classic(f)}else{if(f.isEven()){y=new ArcotJSBN.Barrett(f)}else{y=new ArcotJSBN.Montgomery(f)}}var p=new Array(),d=3,u=h-1,a=(1<<h)-1;p[1]=y.convert(this);if(h>1){var C=ArcotJSBN.nbi();y.sqrTo(p[1],C);while(d<=a){p[d]=ArcotJSBN.nbi();y.mulTo(C,p[d-2],p[d]);d+=2}}var l=s.t-1,A,x=true,c=ArcotJSBN.nbi(),B;o=ArcotJSBN.nbits(s[l])-1;while(l>=0){if(o>=u){A=(s[l]>>(o-u))&a}else{A=(s[l]&((1<<(o+1))-1))<<(u-o);if(l>0){A|=s[l-1]>>(this.DB+o-u)}}d=h;while((A&1)==0){A>>=1;--d}if((o-=d)<0){o+=this.DB;--l}if(x){p[A].copyTo(b);x=false}else{while(d>1){y.sqrTo(b,c);y.sqrTo(c,b);d-=2}if(d>0){y.sqrTo(b,c)}else{B=b;b=c;c=B}y.mulTo(c,p[A],b)}while(l>=0&&(s[l]&(1<<o))==0){y.sqrTo(b,c);B=b;b=c;c=B;if(--o<0){o=this.DB-1;--l}}}var q=y.revert(b);return q};ArcotJSBN.bnGCD=function(c){var b=(this.s<0)?this.negate():this.clone();var j=(c.s<0)?c.negate():c.clone();if(b.compareTo(j)<0){var f=b;b=j;j=f}var d=b.getLowestSetBit(),h=j.getLowestSetBit();if(h<0){return b}if(d<h){h=d}if(h>0){b.rShiftTo(h,b);j.rShiftTo(h,j)}while(b.signum()>0){if((d=b.getLowestSetBit())>0){b.rShiftTo(d,b)}if((d=j.getLowestSetBit())>0){j.rShiftTo(d,j)}if(b.compareTo(j)>=0){b.subTo(j,b);b.rShiftTo(1,b)}else{j.subTo(b,j);j.rShiftTo(1,j)}}if(h>0){j.lShiftTo(h,j)}return j};ArcotJSBN.bnpModInt=function(f){if(f<=0){return 0}var c=this.DV%f,b=(this.s<0)?f-1:0;if(this.t>0){if(c==0){b=this[0]%f}else{for(var a=this.t-1;a>=0;--a){b=(c*b+this[a])%f}}}return b};ArcotJSBN.bnModInverse=function(g){var k=g.isEven();if((this.isEven()&&k)||g.signum()==0){return ArcotJSBN.BigInteger.ZERO}var j=g.clone(),i=this.clone();var h=ArcotJSBN.nbv(1),f=ArcotJSBN.nbv(0),n=ArcotJSBN.nbv(0),l=ArcotJSBN.nbv(1);while(j.signum()!=0){while(j.isEven()){j.rShiftTo(1,j);if(k){if(!h.isEven()||!f.isEven()){h.addTo(this,h);f.subTo(g,f)}h.rShiftTo(1,h)}else{if(!f.isEven()){f.subTo(g,f)}}f.rShiftTo(1,f)}while(i.isEven()){i.rShiftTo(1,i);if(k){if(!n.isEven()||!l.isEven()){n.addTo(this,n);l.subTo(g,l)}n.rShiftTo(1,n)}else{if(!l.isEven()){l.subTo(g,l)}}l.rShiftTo(1,l)}if(j.compareTo(i)>=0){j.subTo(i,j);if(k){h.subTo(n,h)}f.subTo(l,f)}else{i.subTo(j,i);if(k){n.subTo(h,n)}l.subTo(f,l)}}if(i.compareTo(ArcotJSBN.BigInteger.ONE)!=0){return ArcotJSBN.BigInteger.ZERO}if(l.compareTo(g)>=0){return l.subtract(g)}if(l.signum()<0){l.addTo(g,l)}else{return l}if(l.signum()<0){return l.add(g)}else{return l}};ArcotJSBN.lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509];ArcotJSBN.lplim=(1<<26)/ArcotJSBN.lowprimes[ArcotJSBN.lowprimes.length-1];ArcotJSBN.bnIsProbablePrime=function(f){var d,b=this.abs();if(b.t==1&&b[0]<=ArcotJSBN.lowprimes[ArcotJSBN.lowprimes.length-1]){for(d=0;d<ArcotJSBN.lowprimes.length;++d){if(b[0]==ArcotJSBN.lowprimes[d]){return true}}return false}if(b.isEven()){return false}d=1;while(d<ArcotJSBN.lowprimes.length){var a=ArcotJSBN.lowprimes[d],c=d+1;while(c<ArcotJSBN.lowprimes.length&&a<ArcotJSBN.lplim){a*=ArcotJSBN.lowprimes[c++]}a=b.modInt(a);while(d<c){if(a%ArcotJSBN.lowprimes[d++]==0){return false}}}return b.millerRabin(f)};ArcotJSBN.bnpMillerRabin=function(g){var h=this.subtract(ArcotJSBN.BigInteger.ONE);var c=h.getLowestSetBit();if(c<=0){return false}var l=h.shiftRight(c);g=(g+1)>>1;if(g>ArcotJSBN.lowprimes.length){g=ArcotJSBN.lowprimes.length}var b=ArcotJSBN.nbi();for(var f=0;f<g;++f){b.fromInt(ArcotJSBN.lowprimes[f]);var m=b.modPow(l,this);if(m.compareTo(ArcotJSBN.BigInteger.ONE)!=0&&m.compareTo(h)!=0){var d=1;while(d++<c&&m.compareTo(h)!=0){m=m.modPowInt(2,this);if(m.compareTo(ArcotJSBN.BigInteger.ONE)==0){return false}}if(m.compareTo(h)!=0){return false}}}return true};ArcotJSBN.BigInteger.prototype.chunkSize=ArcotJSBN.bnpChunkSize;ArcotJSBN.BigInteger.prototype.toRadix=ArcotJSBN.bnpToRadix;ArcotJSBN.BigInteger.prototype.fromRadix=ArcotJSBN.bnpFromRadix;ArcotJSBN.BigInteger.prototype.fromNumber=ArcotJSBN.bnpFromNumber;ArcotJSBN.BigInteger.prototype.bitwiseTo=ArcotJSBN.bnpBitwiseTo;ArcotJSBN.BigInteger.prototype.changeBit=ArcotJSBN.bnpChangeBit;ArcotJSBN.BigInteger.prototype.addTo=ArcotJSBN.bnpAddTo;ArcotJSBN.BigInteger.prototype.dMultiply=ArcotJSBN.bnpDMultiply;ArcotJSBN.BigInteger.prototype.dAddOffset=ArcotJSBN.bnpDAddOffset;ArcotJSBN.BigInteger.prototype.multiplyLowerTo=ArcotJSBN.bnpMultiplyLowerTo;ArcotJSBN.BigInteger.prototype.multiplyUpperTo=ArcotJSBN.bnpMultiplyUpperTo;ArcotJSBN.BigInteger.prototype.modInt=ArcotJSBN.bnpModInt;ArcotJSBN.BigInteger.prototype.millerRabin=ArcotJSBN.bnpMillerRabin;ArcotJSBN.BigInteger.prototype.clone=ArcotJSBN.bnClone;ArcotJSBN.BigInteger.prototype.intValue=ArcotJSBN.bnIntValue;ArcotJSBN.BigInteger.prototype.byteValue=ArcotJSBN.bnByteValue;ArcotJSBN.BigInteger.prototype.shortValue=ArcotJSBN.bnShortValue;ArcotJSBN.BigInteger.prototype.signum=ArcotJSBN.bnSigNum;ArcotJSBN.BigInteger.prototype.toByteArray=ArcotJSBN.bnToByteArray;ArcotJSBN.BigInteger.prototype.equals=ArcotJSBN.bnEquals;ArcotJSBN.BigInteger.prototype.min=ArcotJSBN.bnMin;ArcotJSBN.BigInteger.prototype.max=ArcotJSBN.bnMax;ArcotJSBN.BigInteger.prototype.and=ArcotJSBN.bnAnd;ArcotJSBN.BigInteger.prototype.or=ArcotJSBN.bnOr;ArcotJSBN.BigInteger.prototype.xor=ArcotJSBN.bnXor;ArcotJSBN.BigInteger.prototype.andNot=ArcotJSBN.bnAndNot;ArcotJSBN.BigInteger.prototype.not=ArcotJSBN.bnNot;ArcotJSBN.BigInteger.prototype.shiftLeft=ArcotJSBN.bnShiftLeft;ArcotJSBN.BigInteger.prototype.shiftRight=ArcotJSBN.bnShiftRight;ArcotJSBN.BigInteger.prototype.getLowestSetBit=ArcotJSBN.bnGetLowestSetBit;ArcotJSBN.BigInteger.prototype.bitCount=ArcotJSBN.bnBitCount;ArcotJSBN.BigInteger.prototype.testBit=ArcotJSBN.bnTestBit;ArcotJSBN.BigInteger.prototype.setBit=ArcotJSBN.bnSetBit;ArcotJSBN.BigInteger.prototype.clearBit=ArcotJSBN.bnClearBit;ArcotJSBN.BigInteger.prototype.flipBit=ArcotJSBN.bnFlipBit;ArcotJSBN.BigInteger.prototype.add=ArcotJSBN.bnAdd;ArcotJSBN.BigInteger.prototype.subtract=ArcotJSBN.bnSubtract;ArcotJSBN.BigInteger.prototype.multiply=ArcotJSBN.bnMultiply;ArcotJSBN.BigInteger.prototype.divide=ArcotJSBN.bnDivide;ArcotJSBN.BigInteger.prototype.remainder=ArcotJSBN.bnRemainder;ArcotJSBN.BigInteger.prototype.divideAndRemainder=ArcotJSBN.bnDivideAndRemainder;ArcotJSBN.BigInteger.prototype.modPow=ArcotJSBN.bnModPow;ArcotJSBN.BigInteger.prototype.modInverse=ArcotJSBN.bnModInverse;ArcotJSBN.BigInteger.prototype.pow=ArcotJSBN.bnPow;ArcotJSBN.BigInteger.prototype.gcd=ArcotJSBN.bnGCD;ArcotJSBN.BigInteger.prototype.isProbablePrime=ArcotJSBN.bnIsProbablePrime;var ArcotPRNG={};ArcotPRNG.Arcfour=function(){this.i=0;this.j=0;this.S=new Array()};ArcotPRNG.ARC4init=function(d){var c,a,b;for(c=0;c<256;++c){this.S[c]=c}a=0;for(c=0;c<256;++c){a=(a+this.S[c]+d[c%d.length])&255;b=this.S[c];this.S[c]=this.S[a];this.S[a]=b}this.i=0;this.j=0};ArcotPRNG.ARC4next=function(){var a;this.i=(this.i+1)&255;this.j=(this.j+this.S[this.i])&255;a=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=a;return this.S[(a+this.S[this.i])&255]};ArcotPRNG.Arcfour.prototype.init=ArcotPRNG.ARC4init;ArcotPRNG.Arcfour.prototype.next=ArcotPRNG.ARC4next;ArcotPRNG.prng_newstate=function(){return new ArcotPRNG.Arcfour()};ArcotPRNG.rng_psize=256;ArcotPRNG.rng_state;ArcotPRNG.rng_pool;ArcotPRNG.rng_pptr;ArcotPRNG.rng_seed_int=function(a){ArcotPRNG.rng_pool[ArcotPRNG.rng_pptr++]^=a&255;ArcotPRNG.rng_pool[ArcotPRNG.rng_pptr++]^=(a>>8)&255;ArcotPRNG.rng_pool[ArcotPRNG.rng_pptr++]^=(a>>16)&255;ArcotPRNG.rng_pool[ArcotPRNG.rng_pptr++]^=(a>>24)&255;if(ArcotPRNG.rng_pptr>=ArcotPRNG.rng_psize){ArcotPRNG.rng_pptr-=ArcotPRNG.rng_psize}};ArcotPRNG.rng_seed_time=function(){ArcotPRNG.rng_seed_int(new Date().getTime())};if(ArcotPRNG.rng_pool==null){ArcotPRNG.rng_pool=new Array();ArcotPRNG.rng_pptr=0;ArcotPRNG.t;if(navigator.appName=="Netscape"&&navigator.appVersion<"5"&&window.crypto){ArcotPRNG.z=window.crypto.random(32);for(ArcotPRNG.t=0;ArcotPRNG.t<ArcotPRNG.z.length;++ArcotPRNG.t){ArcotPRNG.rng_pool[ArcotPRNG.rng_pptr++]=ArcotPRNG.z.charCodeAt(ArcotPRNG.t)&255}}while(ArcotPRNG.rng_pptr<ArcotPRNG.rng_psize){ArcotPRNG.t=Math.floor(65536*Math.random());ArcotPRNG.rng_pool[ArcotPRNG.rng_pptr++]=ArcotPRNG.t>>>8;ArcotPRNG.rng_pool[ArcotPRNG.rng_pptr++]=ArcotPRNG.t&255}ArcotPRNG.rng_pptr=0;ArcotPRNG.rng_seed_time()}ArcotPRNG.rng_get_byte=function(){if(ArcotPRNG.rng_state==null){ArcotPRNG.rng_seed_time();ArcotPRNG.rng_state=ArcotPRNG.prng_newstate();ArcotPRNG.rng_state.init(ArcotPRNG.rng_pool);for(ArcotPRNG.rng_pptr=0;ArcotPRNG.rng_pptr<ArcotPRNG.rng_pool.length;++ArcotPRNG.rng_pptr){ArcotPRNG.rng_pool[ArcotPRNG.rng_pptr]=0}ArcotPRNG.rng_pptr=0}return ArcotPRNG.rng_state.next()};ArcotPRNG.rng_get_bytes=function(b){var a;for(a=0;a<b.length;++a){b[a]=ArcotPRNG.rng_get_byte()}};ArcotPRNG.SecureRandom=function(){};ArcotPRNG.SecureRandom.prototype.nextBytes=ArcotPRNG.rng_get_bytes;var ArcotRSA={};ArcotRSA.parseBigInt=function(b,a){return new ArcotJSBN.BigInteger(b,a)};ArcotRSA.linebrk=function(c,d){var a="";var b=0;while(b+d<c.length){a+=c.substring(b,b+d)+"\n";b+=d}return a+c.substring(b,c.length)};ArcotRSA.byte2Hex=function(a){if(a<16){return"0"+a.toString(16)}else{return a.toString(16)}};ArcotRSA.pkcs1pad2=function(d,g){if(g<d.length+11){alert("Message too long for RSA");return null}var f=new Array();var c=d.length-1;while(c>=0&&g>0){f[--g]=d.charCodeAt(c--)}f[--g]=0;var b=new SecureRandom();var a=new Array();while(g>2){a[0]=0;while(a[0]==0){b.nextBytes(a)}f[--g]=a[0]}f[--g]=2;f[--g]=0;return new ArcotJSBN.BigInteger(f)};ArcotRSA.RSAKey=function(){this.n=null;this.e=0;this.d=null;this.p=null;this.q=null;this.dmp1=null;this.dmq1=null;this.coeff=null};ArcotRSA.RSASetPublic=function(b,a){if(b!=null&&a!=null&&b.length>0&&a.length>0){this.n=ArcotRSA.parseBigInt(b,16);this.e=parseInt(a,16)}else{alert("Invalid RSA public key")}};ArcotRSA.RSADoPublic=function(a){return a.modPowInt(this.e,this.n)};ArcotRSA.RSAEncrypt=function(d){var a=ArcotRSA.pkcs1pad2(d,(this.n.bitLength()+7)>>3);if(a==null){return null}var f=this.doPublic(a);if(f==null){return null}var b=f.toString(16);if((b.length&1)==0){return b}else{return"0"+b}};ArcotRSA.RSAKey.prototype.doPublic=ArcotRSA.RSADoPublic;ArcotRSA.RSAKey.prototype.setPublic=ArcotRSA.RSASetPublic;ArcotRSA.RSAKey.prototype.encrypt=ArcotRSA.RSAEncrypt;ArcotRSA.pkcs1unpad2=function(g,h){var a=g.toByteArray();var f=0;while(f<a.length&&a[f]==0){++f}if(a.length-f!=h-1||a[f]!=2){return null}++f;while(a[f]!=0){if(++f>=a.length){return null}}var c="";while(++f<a.length){c+=String.fromCharCode(a[f])}return c};ArcotRSA.RSASetPrivate=function(c,a,b){if(c!=null&&a!=null&&c.length>0&&a.length>0){this.n=ArcotRSA.parseBigInt(c,16);this.e=parseInt(a,16);this.d=ArcotRSA.parseBigInt(b,16)}else{alert("Invalid RSA private key")}};ArcotRSA.RSASetPrivateEx=function(h,d,f,c,b,a,i,g){if(h!=null&&d!=null&&h.length>0&&d.length>0){this.n=ArcotRSA.parseBigInt(h,16);this.e=parseInt(d,16);this.d=ArcotRSA.parseBigInt(f,16);this.p=ArcotRSA.parseBigInt(c,16);this.q=ArcotRSA.parseBigInt(b,16);this.dmp1=ArcotRSA.parseBigInt(a,16);this.dmq1=ArcotRSA.parseBigInt(i,16);this.coeff=ArcotRSA.parseBigInt(g,16)}else{alert("Invalid RSA private key")}};ArcotRSA.RSAGenerate=function(b,j){var a=new SecureRandom();var g=b>>1;this.e=parseInt(j,16);var c=new ArcotJSBN.BigInteger(j,16);for(;;){for(;;){this.p=new ArcotJSBN.BigInteger(b-g,1,a);if(this.p.subtract(ArcotJSBN.BigInteger.ONE).gcd(c).compareTo(ArcotJSBN.BigInteger.ONE)==0&&this.p.isProbablePrime(10)){break}}for(;;){this.q=new ArcotJSBN.BigInteger(g,1,a);if(this.q.subtract(ArcotJSBN.BigInteger.ONE).gcd(c).compareTo(ArcotJSBN.BigInteger.ONE)==0&&this.q.isProbablePrime(10)){break}}if(this.p.compareTo(this.q)<=0){var i=this.p;this.p=this.q;this.q=i}var h=this.p.subtract(ArcotJSBN.BigInteger.ONE);var d=this.q.subtract(ArcotJSBN.BigInteger.ONE);var f=h.multiply(d);if(f.gcd(c).compareTo(ArcotJSBN.BigInteger.ONE)==0){this.n=this.p.multiply(this.q);this.d=c.modInverse(f);this.dmp1=this.d.mod(h);this.dmq1=this.d.mod(d);this.coeff=this.q.modInverse(this.p);break}}};ArcotRSA.RSADoPrivate=function(a){if(this.p==null||this.q==null){return a.modPow(this.d,this.n)}var c=a.mod(this.p).modPow(this.dmp1,this.p);var b=a.mod(this.q).modPow(this.dmq1,this.q);while(c.compareTo(b)<0){c=c.add(this.p)}return c.subtract(b).multiply(this.coeff).mod(this.p).multiply(this.q).add(b)};ArcotRSA.RSADecrypt=function(b){var d=ArcotRSA.parseBigInt(b,16);var a=this.doPrivate(d);if(a==null){return null}return ArcotRSA.pkcs1unpad2(a,(this.n.bitLength()+7)>>3)};ArcotRSA.RSAKey.prototype.doPrivate=ArcotRSA.RSADoPrivate;ArcotRSA.RSAKey.prototype.setPrivate=ArcotRSA.RSASetPrivate;ArcotRSA.RSAKey.prototype.setPrivateEx=ArcotRSA.RSASetPrivateEx;ArcotRSA.RSAKey.prototype.generate=ArcotRSA.RSAGenerate;ArcotRSA.RSAKey.prototype.decrypt=ArcotRSA.RSADecrypt;function DevLockerCurrent(c){this.obj=c;var b=new AuthMinderPlugin().getPlugin();if(b!=null){var a={};b.GetDeviceDNA(a);this.dlVersion=parseInt(a.version);ArcotLogger.log("Current device locking version is:"+this.dlVersion)}else{this.dlVersion=0}}DevLockerCurrent.prototype.doDevLockMigration=function(d){if(d.getType()=="plugin"){var l={};var p=d.GetAll();var q=p.length;for(var f=0;f<q;f++){try{var r=p[f];var a=WalletUtil.parse(d.serialize(r));var o=r.dltu;if(o){var b=o.split(":");if(b.length==1){ArcotLogger.log("DevLockerCurrent::doDevLockMigration found V2 records");var c=b[0];var g=2;if(g==this.dlVersion){continue}if(o.toLowerCase()==StoreImplPlugin.DLTU_NONE){r.dltu=this.dlVersion.toString()+":"+StoreImplPlugin.DLTU_NONE}else{var k=this.getKeyForVersion(c,g);this.recamoWithCurrentDLKey(a,d,r,k)}}else{if(b.length==2){var n=b[0];var g=parseInt(n);if(g==this.dlVersion){continue}else{if(g<this.dlVersion){var c=b[1];if(c.toLowerCase()==StoreImplPlugin.DLTU_NONE){r.dltu=this.dlVersion.toString()+":"+StoreImplPlugin.DLTU_NONE}else{var k=this.getKeyForVersion(c,g);this.recamoWithCurrentDLKey(a,d,r,k)}}}}}}else{var g=1;var m=this.getKeyForVersion(null,g);this.recamoWithCurrentDLKey(a,d,r,m)}var j=d.Save(r,l);if(j!=ArcotErrorCodes.ERR_NONE){ArcotLogger.log("Migration Error code is:"+j);continue}}catch(h){ArcotLogger.log("Exception in doDevLockMigration:"+h);continue}}}return};DevLockerCurrent.prototype.recamoWithCurrentDLKey=function(c,d,b,f){var a=d.unlock(c,b,f);var h=ArcotAIDMobile.bytear2hexstr(a);var g=c.arcotcards[0].arcotPrivateKey.camouflagedKey;d.replaceKey(b,g,h);d.deviceLock(b,d.getType())};DevLockerCurrent.prototype.isValid=function isValid(){if(this.dlVersion>=3){return true}return false};DevLockerCurrent.prototype.GetVersion=function(){return this.dlVersion};DevLockerCurrent.prototype.getKey=function getKey(a,i,c,f){try{var g=new AuthMinderPlugin().getPlugin();if(!g){return null}if(a&&(a.toUpperCase()=="FALSE"||a.toUpperCase()=="NO")){f.dltu=this.dlVersion.toString()+":"+StoreImplPlugin.DLTU_NONE;return null}var j={DNA:null};if(c){if(this.dlVersion==3){if((i!=undefined)&&i!=null){j.inputAttributes=i}else{j.inputAttributes=""}}}else{if((i==undefined)||i==null){return null}var b=i.split(":");if(b.size==2){j.inputAttributes=b[1]}}var d=g.GetDeviceDNA(j);if(d==AuthMinderPlugin.E_SUCCESS){var k=j.DNA;f.dltu=this.dlVersion.toString()+":"+j.outputAttributes;ArcotLogger.log("DeviceLock: done");return k}}catch(h){ArcotLogger.log("Exception while getting DeviceLock: "+h)}return null};DevLockerCurrent.prototype.getKeyForVersion=function(f,b){try{var g=new AuthMinderPlugin().getPlugin();if(!g){return null}var d={version:b.toString(),DNA:null};if(b>1&&b<this.dlVersion){if(f){d.inputAttributes=f}}var a=g.GetDeviceDNA(d);if(a==AuthMinderPlugin.E_SUCCESS){var c=d.DNA;return c}}catch(h){}return null};function StoreAID(a){this.devicelocker=a&&"devicelocker" in a?a.devicelocker:null;StoreBase.call(this,a);if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}}StoreAID.PLUGIN_DLTUSTR="_dltu_";StoreAID.prototype=new StoreBase({inheriting:true});StoreAID.base=StoreBase.prototype;StoreAID.prototype.GetAll=function(){var g={};var f=[];StoreAID.base.loadAll.call(this,g);var k=g.values;var j=g.keys;var c=g.dltus;for(var d=0;d<k.length;d++){var b=WalletUtil.parse(this.serialize(k[d]));var h=this.getKey(b);if(h=="arcot.wallet.memory"&&this.impl.getType()=="cookie"){continue}if(h=="arcot.wallet.0"&&this.impl.getType()=="memory"){continue}var a=k[d];if(c!=undefined&&c!=null){a.dltu=c[d]}f.push(a)}return f};StoreAID.prototype.Get=function(g,f){g=g.toUpperCase();if(f!=null){f=f.toUpperCase()}var a=this.GetAll();for(var c=0;c<a.length;c++){var d=this.serialize(a[c]);var b=WalletUtil.parse(d);b.dltu=a[c].dltu;if(g==b.walletname.toUpperCase()){if(f==null||f.length==0){return b}if(f==b.arcotcards[0].orgname.toUpperCase()){return b}}}return null};StoreAID.prototype.Save=function(b,f){var c=WalletUtil.parse(b.b64EncodedArcotID);var d=this.getKey(c);if(f==undefined||f==null){f={}}f.inputAttributes=b.dltu;var a=StoreAID.base.save.call(this,d,b,f);if(a){return ArcotErrorCodes.ERR_NONE}return ArcotErrorCodes.ERR_UNKNOWN};StoreAID.prototype.getKey=function(a){var b;if(this.impl instanceof StoreImplCookies){b="arcot.wallet.0"}else{if(this.impl instanceof StoreImplMemory){b="arcot.wallet.memory"}else{b="aid_"+WalletUtil.getItemNameFromWallet(a)}}return b};StoreAID.prototype.GetWalletCount=function(){var a=this.GetAll();return a.length};StoreAID.prototype.GetWalletAt=function(c){var a=this.GetAll();if(c>=a.length){return null}var d=a[c].b64EncodedArcotID;var b=WalletUtil.parse(d);b.dltu=a[c].dltu;return b};StoreAID.prototype.Delete=function(a,d){var b=this.Get(a,d);if(b){var c=this.getKey(b);return StoreAID.base.remove.call(this,c)}return false};StoreAID.prototype.DeleteByAlias=function(f,h,a){var k=this.GetAll();for(var c=0;c<k.length;c++){var b=k[c];var g=WalletUtil.parse(b);var j="Alias."+a;var d=g.arcotcards[0].namedAttributes[j];if(d!=null){d=ArcotUtil.util_hex2str(d)}if(d!=null&&d.toUpperCase()==f.toUpperCase()){if(h==null||h.length==0){var l=this.getKey(g);return StoreAID.base.remove.call(this,l)}if(h.toUpperCase()==g.arcotcards[0].orgname.toUpperCase()){var l=this.getKey(g);return StoreAID.base.remove.call(this,l)}}}return false};StoreAID.prototype.DeleteAll=function(){var a=this.GetAll();for(var d=0;d<a.length;d++){var f=a[d];var b=WalletUtil.parse(f);var c=this.getKey(b);StoreAID.base.remove.call(this,c)}};StoreAID.prototype.serialize=function(a){return a.b64EncodedArcotID};StoreAID.prototype.deserialize=function(a){var b=Object();b.b64EncodedArcotID=a;b.dltu="";b.key="";return b};StoreAID.prototype.isValidEntry=function(a,b){return((a.substr(0,12)=="arcot.wallet")||(a.substr(0,4)=="aid_"))};StoreAID.prototype.getDevLockKey=function(b,f,a){if(f!="plugin"||this.devicelocker==null){return null}var d;var c=new Object;var h;h=b.arcotcards[0].namedAttributes[StoreImplPlugin.DLR];if((h!=undefined)&&h!=null){h=ArcotUtil.util_hex2str(h)}if(a){var g=b.arcotcards[0].namedAttributes[StoreImplPlugin.DLT];if((g!=undefined)&&g!=null){g=ArcotUtil.util_hex2str(g)}d=this.devicelocker.getKey(h,g,true,c);b.dltu=c.dltu}else{if(b.dltu==StoreImplPlugin.DLTU_NONE){return null}d=this.devicelocker.getKey(h,b.dltu,false,c);b.dltu=c.dltu}if(d==null){return d}d=d.trim();if(d.length==0){return null}return d};StoreAID.prototype.deviceLock=function(a,d){if(d!="plugin"||this.devicelocker==null){return false}if(!a.hasOwnProperty("b64EncodedArcotID")){return false}var b=WalletUtil.parse(a.b64EncodedArcotID);if(b==null){return false}var c=this.getDevLockKey(b,this.getType(),true);a.dltu=b.dltu;if(c==null){return false}c=c.trim();if(c.length==0){return false}return this.lock(b,a,c)};StoreAID.prototype.lock=function(d,b,g){var i=new ArcotAIDMobile.ArcotDigestRep(d.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageType,d.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.salt,d.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.iterationCount,d.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.checksum,d.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.start,d.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.span);var f=ArcotAIDMobile.hexstr2bytes(d.arcotcards[0].arcotPrivateKey.camouflagedKey);var h=i.applyPinToKey(g,f);var c=ArcotAIDMobile.bytear2hexstr(h);var a=d.arcotcards[0].arcotPrivateKey.camouflagedKey;return this.replaceKey(b,a,c)};StoreAID.prototype.replaceKey=function(b,a,c){if(c&&c.length==a.length){var d=ArcotBase64.b64tohex(b.b64EncodedArcotID);d=d.replace(a,c);b.b64EncodedArcotID=ArcotBase64.hex2b64(d);return true}return false};StoreAID.prototype.deviceUnlock=function(g,f,b,a){if(f!="plugin"||this.devicelocker==null){return false}if(a==undefined&&g.hasOwnProperty("b64EncodedArcotID")){a=WalletUtil.parse(g.b64EncodedArcotID)}var d=this.getDevLockKey(a,this.getType(),false);if(d==null){return false}d=d.trim();if(d.length==0){return false}var c=this.unlock(a,g,d);var h=new ArcotAIDMobile.ArcotDigestRep(a.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageType,a.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.salt,a.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.iterationCount,a.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.checksum,a.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.start,a.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.span);g.decamkey=h.decrypt(b,c);return true};StoreAID.prototype.unlock=function(a,f,c){var d=ArcotAIDMobile.hexstr2bytes(a.arcotcards[0].arcotPrivateKey.camouflagedKey);var g=new ArcotAIDMobile.ArcotDigestRep(a.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageType,a.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.salt,a.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.iterationCount,a.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.checksum,a.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.start,a.arcotcards[0].arcotPrivateKey.arcotDigest.camouflageParameters.span);var b=g.applyPinToKey(c,d);return b};StoreAID.prototype.doDevLockMigration=function(){if(this.getType()!="plugin"||this.devicelocker==null){return}this.devicelocker.doDevLockMigration(this)};StoreAID.prototype.doDevLockMigrationV2=function(){if(this.getType()=="plugin"){var j={};var n=this.GetAll();var o=n.length;for(var d=0;d<o;d++){try{var p=n[d];var b=WalletUtil.parse(this.serialize(p));var m=p.dltu;if(m){}else{var f=new DeviceLock(this.obj);var l=f.getKey(null,false,null);var k=this.unlock(b,p,l);var c=ArcotAIDMobile.bytear2hexstr(k);var a=b.arcotcards[0].arcotPrivateKey.camouflagedKey;this.replaceKey(p,a,c);this.deviceLock(p,this.getType());var h=this.Save(p,j);if(h!=ArcotErrorCodes.ERR_NONE){ArcotLogger.log("Migration Error code is:"+h)}}}catch(g){ArcotLogger.log("Exception in doDevLockMigrationV2:"+g);continue}}}return};function StoreAIDMemoryStorage(a){if(!a){a={}}a.storageType=StoreImplMemory;a.autoMigrate=false;StoreAID.call(this,a);return}StoreAIDMemoryStorage.prototype=new StoreAID({inheriting:true});var ArcotLogger={};ArcotLogger.debug=false;ArcotLogger.log=function(a){if(ArcotLogger.debug){alert(a)}};var ArcotUtil={util_hex2str:function(c){var a=0;var b="";while(a<c.length){b+="%"+c.substr(a,2);a+=2}return decodeURIComponent(b)},util_hex2tstring:function(d){if((d.length%2)!=0){return""}var c,a,b="";for(c=0;c<d.length;c+=2){a=parseInt(d.substring(c,c+2),16);b+=String.fromCharCode(a)}return b},util_tstring2hex:function(c){var b="";var a;for(a=0;a<c.length;a++){b+=ArcotUtil.util_byte2hex(c.charCodeAt(a))}return b},util_hex2bytes:function(f){if((f.length%2)!=0){return""}var d,c;var b=new Array();for(d=0;d<f.length;d+=2){c=parseInt(f.substring(d,d+2),16);b[d/2]=String.fromCharCode(c)}return b},util_hex2bytearray:function(f){if((f.length%2)!=0){return""}var d,c;var b=new Array();for(d=0;d<f.length;d+=2){b[d/2]=parseInt(f.substring(d,d+2),16)}return b},util_byte2hex:function(a){var c=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");var g=(a>>4)&15;var f=(a&15);var d=c[g]+c[f];return d},util_bytes2tstring:function(b){var f;var d;for(d=0;d<b.length;d++){var g=b[d];f+=String.fromCharCode(g)}return},flip:function(b){var a="f0F0 e1E1 d2D2 c3C3 b4B4 a5A5 696 787";return a.charAt(a.indexOf(b)+1)},util_flipBits:function(c){var b="";for(var a=0;a<c.length;a++){b+=ArcotUtil.flip(c.charAt(a))}return b}};WalletUtil=new Object();WalletUtil.parse=function(d){var a=ArcotBase64.b64tohex(d);var c=new ArcotAIDMobile.ArcotWallet();var b=ArcotASN1JS.decode(a,c);return c};WalletUtil.getItemNameFromWallet=function(c){var b=c.walletname;var f=c.arcotcards[0].orgname;var d=window.location.hostname;if(ArcotAIDMobile.debug){alert("Walletname is :"+b)}if(ArcotAIDMobile.debug){alert("Org name is:"+f)}if(ArcotAIDMobile.debug){alert("Domain name is:"+d)}var g=b+f+d;g=unescape(encodeURIComponent(g));var a=ArcotSHA1.hex_sha1(g.toUpperCase());if(ArcotAIDMobile.debug){alert(a)}return a};WalletUtil.getFileName=function(b,d){var c=window.location.hostname;var f=b+d+c;f=unescape(encodeURIComponent(f));var a=ArcotSHA1.hex_sha1(f.toUpperCase());if(ArcotAIDMobile.debug){alert(a)}return a};WalletUtil.getCardAttribute=function(a,b){return a.arcotcards[0].namedAttributes[b]};try{if(typeof arcotClientReady_!="undefined"){arcotClientReady_()}}catch(e){}try{if(typeof lt_arcotClientReady_!="undefined"){lt_arcotClientReady_()}}catch(e){};